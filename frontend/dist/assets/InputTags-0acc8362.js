import{j as t,g as S,r}from"./index-c193dc40.js";import{c as R}from"./index.esm-54ce3fd1.js";import{B as k}from"./Badge-8491b435.js";import{F as C}from"./FormControl-cc700203.js";import{B as F}from"./Button-b8db3fe4.js";const I=({name:o,state:d,className:f,onClick:a})=>{const i=()=>{typeof a=="function"&&a()},u="bg-secondary-subtle text-secondary d-inline-flex align-items-center gap-1 "+(f??"");return t.jsxs(k,{className:u,style:{cursor:"default",padding:"0.4rem 0.6rem"},children:[t.jsx("span",{children:o}),d==="cancellable"&&t.jsx("button",{className:"d-flex align-items-center justify-content-center text-danger fw-bold",onClick:i,style:{outline:"none",background:"none",border:"none",fontSize:"1.1rem",lineHeight:1,cursor:"pointer"},children:t.jsx(R,{})})]})},W=({query:o,placeholder:d="Search...",maxWidthPx:f=360,handleSearch:a,size:i})=>{const{sendJsonRequest:u}=S(),[p,w]=r.useState([]),[c,g]=r.useState(o),[x,y]=r.useState([]),[j,b]=r.useState(!1),e=r.useRef(null);r.useEffect(()=>{s()},[]),r.useEffect(()=>{g(o)},[o]),r.useEffect(()=>{y(l(c,p))},[c,p]);const s=async()=>{const n=await u("/Tag","POST");if(n){const m=n.map(h=>h.name);w(m)}},l=(n,m)=>{const h=n.trim();return h.length===0?m.slice(0,10):m.filter(T=>T.toLowerCase().startsWith(h.toLowerCase())&&T.toLowerCase()!==h.toLowerCase()).slice(0,10)},v=n=>{g(n)};return t.jsxs("div",{className:"d-flex gap-2",children:[t.jsxs("div",{className:"position-relative",style:{width:"100%"},children:[t.jsx(C,{ref:e,type:"search",size:i,placeholder:d,value:c,onChange:n=>g(n.target.value),onFocus:()=>b(!0),onBlur:()=>b(!1),style:{width:"100%"},"aria-autocomplete":"list","aria-expanded":x.length>0,onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),a(c),e.current&&e.current.blur())}}),j&&x.length>0&&t.jsx("ul",{className:"position-absolute list-unstyled m-0 p-1",style:{top:"100%",left:0,zIndex:1e3,background:"white",border:"1px solid #ccc",borderRadius:"0.25rem",maxHeight:"150px",overflowY:"auto",width:`min(100%, ${f}px)`,boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},role:"listbox",children:x.map(n=>t.jsx("li",{style:{cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},onClick:()=>v(n),onMouseDown:m=>m.preventDefault(),className:"hover-bg-light",role:"option","aria-selected":!1,children:n},`filtered-tag-${n}`))})]}),t.jsx(F,{size:i,onClick:()=>a(c),children:"Search"})]})},z=({values:o,setValues:d,placeholder:f})=>{const[a,i]=r.useState(""),[u,p]=r.useState([]),[w,c]=r.useState([]),{sendJsonRequest:g}=S();r.useEffect(()=>{x()},[]);const x=async()=>{const e=await g("/Tag","POST");if(e){const s=e.map(l=>l.name);c(s)}},y=e=>{const s=e.target.value.toLowerCase().trim();i(s),s.length>0?p(w.filter(l=>l.startsWith(s)&&!o.includes(l)).slice(0,10)):p([])},j=e=>{o.length>=10||(d(s=>s.includes(e)?[...s]:[...s,e]),i(""),p([]))};let b=o.map(e=>{const s=()=>{d(l=>l.filter(v=>v!==e))};return t.jsx(I,{name:e,state:"cancellable",onClick:s},e)});return t.jsxs("div",{className:"d-flex flex-wrap align-items-center position-relative",style:{minWidth:"200px",gap:"0.25rem"},children:[b,o.length<10&&t.jsxs("div",{className:"d-flex position-relative",children:[t.jsx(C,{type:"text",size:"sm",style:{width:"120px",marginLeft:o.length>0?"0.25rem":"0"},value:a,onChange:e=>y(e),placeholder:f}),u.length>0&&a.length>0&&t.jsx("ul",{className:"position-absolute list-unstyled m-0 p-1",style:{top:"100%",left:0,zIndex:1e3,background:"white",border:"1px solid #ccc",borderRadius:"0.25rem",maxHeight:"150px",overflowY:"auto",width:"150px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:u.map(e=>t.jsx("li",{style:{cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},onClick:()=>j(e),onMouseDown:s=>s.preventDefault(),className:"hover-bg-light",children:e},"filtered-tag-"+e))})]})]})};export{z as I,W as T,I as W};
