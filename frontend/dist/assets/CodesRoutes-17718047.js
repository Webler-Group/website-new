import{K as A,u as F,r as a,j as e,M as B,b as T,af as U,F as D,B as w,Z as J,m as q,O as K,Q,S as W,U as Z,al as G}from"./index-6cb5912a.js";import{C as R}from"./Code-652b7093.js";import{P as V}from"./react-bootstrap-pagination-control.esm-d1edbf74.js";import{Q as X}from"./QuestionPlaceholder-2bac7881.js";import{l as Y}from"./compilerLanguages-5415cd41.js";const _=({MainPage:u})=>{A("Code Playground | Webler Code",!1);const{sendJsonRequest:n}=F(),[d,h]=a.useState([]);a.useEffect(()=>{o()},[]);const o=async()=>{const l=await n("/Codes","POST",{page:1,count:10,filter:5,searchQuery:"",userId:null});l&&l.codes&&h(l.codes)};return e.jsx(B,{children:e.jsxs("div",{className:"row mt-2",style:{minHeight:"100vh"},children:[e.jsx("div",{className:"col-12 col-md-8",children:u}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("h2",{children:"Hot today"}),e.jsx("div",{className:"my-3",children:d.map(l=>e.jsx("div",{className:"mb-2",children:e.jsx(R,{code:l,searchQuery:"",showUserProfile:!1})},l.id))})]})]})})},$=()=>{const{sendJsonRequest:u}=F(),{userInfo:n}=T(),[d,h]=a.useState([]),o=10,[l,m]=a.useState(1),[x,E]=a.useState(0),[L,f]=a.useState(!1),[g,j]=a.useState(1),[I,p]=a.useState("all"),[v,y]=a.useState(""),[C,S]=a.useState(""),[t,c]=U();a.useEffect(()=>{O()},[t]),a.useEffect(()=>{N(1)},[g,C]),a.useEffect(()=>{t.has("page")&&m(Number(t.get("page"))),t.has("filter")&&j(Number(t.get("filter"))),t.has("query")&&(y(t.get("query")),S(t.get("query"))),t.has("language")&&p(t.get("language"))},[]);const N=s=>{l!==s&&(t.set("page",s.toString()),c(t,{replace:!0}),m(s))},P=()=>{const s=v.trim();t.set("query",s),c(t,{replace:!0}),S(s)},O=async()=>{f(!0);const s=t.has("page")?Number(t.get("page")):1,r=t.has("filter")?Number(t.get("filter")):1,H=t.has("query")?t.get("query"):"",k=t.has("language")?t.get("language"):null,i=await u("/Codes","POST",{page:s,count:o,filter:r,searchQuery:H,language:k,userId:n?n.id:null});i&&i.codes&&(h(i.codes),E(i.count)),f(!1)},z=s=>{const r=Number(s.target.selectedOptions[0].value);t.set("filter",r.toString()),c(t,{replace:!0}),j(r)},M=s=>{const r=s.target.selectedOptions[0].value;r==="all"?t.delete("language"):t.set("language",r),c(t,{replace:!0}),p(r)};let b=[];for(let s=0;s<o;++s)b.push(e.jsx(X,{},s));return e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("h2",{children:"Codes"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(D,{type:"search",size:"sm",placeholder:"Search...",value:v,onChange:s=>y(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),P())}}),e.jsx(w,{size:"sm",onClick:P,children:"Search"})]}),e.jsxs("div",{className:"mt-2 d-sm-flex flex-row-reverse justify-content-between",children:[e.jsx("div",{className:"mb-2 mb-sm-0 d-flex justify-content-end",children:e.jsx(J.LinkContainer,{to:"/Compiler-Playground",children:e.jsx(w,{size:"sm",children:"New code"})})}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs(q.Select,{size:"sm",style:{width:"140px"},value:g,onChange:z,children:[e.jsx("option",{value:"1",children:"Most Recent"}),e.jsx("option",{value:"2",children:"Most Popular"}),n&&e.jsx(e.Fragment,{children:e.jsx("option",{value:"3",children:"My Codes"})})]}),e.jsxs(q.Select,{size:"sm",style:{width:"140px"},className:"ms-2",value:I,onChange:M,children:[e.jsx("option",{value:"all",children:"All"},"all"),Object.entries(Y).map(s=>e.jsx("option",{value:s[0],children:s[1].displayName},s[0]))]})]})]}),e.jsx("div",{className:"my-3",children:L?b:x==0?e.jsx("div",{className:"wb-discuss-empty-questions",children:e.jsx("h3",{children:"Nothing to show"})}):d.map(s=>e.jsx("div",{className:"mt-2",children:e.jsx(R,{code:s,searchQuery:C,showUserProfile:g!=3})},s.id))}),e.jsx("div",{className:"my-3",children:e.jsx(V,{page:l,between:3,total:x,limit:o,changePage:N,ellipsis:1})})]})},re=()=>e.jsx(K,{children:e.jsx(Q,{element:e.jsx(W,{Header:e.jsx(Z,{variant:"light"}),Footer:e.jsx(G,{})}),children:e.jsx(Q,{index:!0,element:e.jsx(_,{MainPage:e.jsx($,{})})})})});export{re as default};
