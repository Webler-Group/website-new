import{g as P,f as T,r as s,j as e,i as q}from"./index-c193dc40.js";import{P as L}from"./PasswordFormControl-4c18b887.js";import{R as U}from"./RequestResultAlert-5538ea88.js";import{F as B,a,b as r}from"./Form-19731f2f.js";import{F as i}from"./FormControl-cc700203.js";import{B as j}from"./Button-b8db3fe4.js";const K=({onToggleClick:f,onRegister:S})=>{const{sendJsonRequest:o}=P(),{authenticate:y,updateUser:v,deviceId:b}=T(),[c,C]=s.useState(""),[l,w]=s.useState(""),[u,F]=s.useState(""),[N,m]=s.useState([]),[R,d]=s.useState(!1),[h,k]=s.useState(null),[x,p]=s.useState(null),[g,I]=s.useState("");s.useEffect(()=>{n()},[]);const A=async t=>{t.preventDefault(),d(!0),await E(),d(!1)},n=async()=>{p(null);const t=await o("/Auth/GenerateCaptcha","POST");t&&(k(t.imageData),p(t.captchaId))},E=async()=>{m([]);const t=await o("/Auth/Register","POST",{email:c,name:l,password:u,captchaId:x,solution:g,deviceId:b});t&&t.accessToken&&t.user&&t.expiresIn?(y(t.accessToken,t.expiresIn),v(t.user),S()):(m(t.error),await n())};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center mb-4",children:"Sign Up"}),e.jsxs(B,{onSubmit:t=>A(t),children:[e.jsx(U,{errors:N}),e.jsxs(a,{children:[e.jsx(r,{children:"Email"}),e.jsx(i,{type:"email",required:!0,value:c,onChange:t=>C(t.target.value)})]}),e.jsxs(a,{children:[e.jsx(r,{children:"Name"}),e.jsx(i,{type:"text",minLength:3,maxLength:20,required:!0,value:l,onChange:t=>w(t.target.value)})]}),e.jsxs(a,{children:[e.jsx(r,{children:"Password"}),e.jsx(L,{password:u,setPassword:F})]}),e.jsxs(a,{children:[e.jsx(r,{children:"Captcha"}),e.jsx(i,{type:"text",required:!0,value:g,onChange:t=>I(t.target.value)}),e.jsxs("div",{className:"mt-2 d-flex gap-2",children:[e.jsx("div",{style:{height:"50px"},children:h&&e.jsx("img",{height:"100%",src:h})}),e.jsx("button",{disabled:x===null,onClick:n,className:"d-flex justify-content-center align-items-center",style:{width:"25px",height:"25px"},type:"button",children:"‚ü≥"})]})]}),e.jsx(j,{className:"mt-4 w-100 d-block",type:"submit",disabled:R,children:"Sign up"})]}),e.jsxs("p",{className:"text-center mt-5",children:["Already have an account? ",e.jsx(j,{variant:"link",onClick:f,children:"Sign in"})]}),e.jsxs("p",{className:"text-center mt-2",children:["By signing up you agree to our ",e.jsx(q,{to:"/Terms-of-use",children:"Terms of Use"})]})]})};export{K as R};
