import{d as p,r as l,J as w,e as N,j as s,K as v,S as I,L as S}from"./index-6393846e.js";import{M as h}from"./Modal-1b0ac075.js";const y=(e,f)=>{const{sendJsonRequest:x}=p(),[j,d]=l.useState([]),[c,o]=l.useState(!1),[i,n]=l.useState(!0),[m,b]=l.useState(),[t,u]=l.useState({page:1});return l.useEffect(()=>{(async()=>{if(t.page==0||!e.parentId)return;b(void 0),o(!0);const r=await x("/Feed/GetUserReactions","POST",{parentId:e.parentId,page:t.page,count:f});r&&r.userReactions?(d(g=>t.page==1?r.userReactions:[...g,...r.userReactions]),n(r.userReactions.length===f)):b(r.error),o(!1)})()},[t]),l.useEffect(()=>{d([]),u({page:1})},[e]),{results:j,loading:c,hasNextPage:i,error:m,setState:u}};var A=(e=>(e[e.LIKE=1]="LIKE",e[e.HAHA=2]="HAHA",e[e.ANGRY=3]="ANGRY",e[e.LOVE=4]="LOVE",e[e.SAD=5]="SAD",e[e.WOW=6]="WOW",e))(A||{});const L={1:{emoji:"👍",label:"Like",color:"#1877f2"},4:{emoji:"❤️",label:"Love",color:"#e91e63"},2:{emoji:"😂",label:"Haha",color:"#f39c12"},6:{emoji:"😮",label:"Wow",color:"#f39c12"},5:{emoji:"😢",label:"Sad",color:"#f39c12"},3:{emoji:"😡",label:"Angry",color:"#e74c3c"}},O=w.forwardRef(({item:e,showReactions:f},x)=>{const{sendJsonRequest:j}=p(),[d,c]=l.useState(!1),[o,i]=l.useState(e.isFollowing),{userInfo:n}=N(),m=async()=>{if(!n)return;c(!0);const a=await j("/Profile/Follow","POST",{userId:e.userId});a&&a.success&&i(!0),c(!1)},b=async()=>{if(!n)return;c(!0);const a=await j("/Profile/Unfollow","POST",{userId:e.userId});a&&a.success&&i(!1),c(!1)},t=L[e.reaction],u=s.jsxs("div",{className:"d-flex justify-content-between align-items-start py-2 border-bottom",children:[s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("div",{className:"me-2",children:s.jsx(v,{size:42,avatarImage:e.userAvatar??null})}),s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx(I,{userId:e.userId,userName:e.userName}),f&&s.jsxs("div",{className:"mt-1 d-flex align-items-center",title:t.label,children:[s.jsx("span",{className:"me-1",children:t.emoji}),s.jsx("span",{style:{fontSize:"15px",color:t.color,fontWeight:600},children:t.label})]})]})]}),n&&n.id!==e.userId&&(o?s.jsx("button",{className:"btn btn-outline-secondary btn-sm",disabled:d,onClick:b,children:"Unfollow"}):s.jsx("button",{className:"btn btn-primary btn-sm",disabled:d,onClick:m,children:"Follow"}))]});return x?s.jsx("div",{ref:x,children:u}):s.jsx("div",{children:u})}),R=({options:e,visible:f,onClose:x,title:j,showReactions:d,countPerPage:c})=>{const{results:o,loading:i,hasNextPage:n,error:m,setState:b}=y(e,c),t=l.useRef(),u=l.useCallback(a=>{i||(t.current&&t.current.disconnect(),t.current=new IntersectionObserver(r=>{r[0].isIntersecting&&n&&o.length>0&&b(g=>({page:g.page+1}))}),a&&t.current.observe(a))},[i,n,o]);return s.jsxs(h,{show:f,onHide:x,className:"d-flex justify-content-center align-items-center",style:{zIndex:1070},backdropClassName:"wb-reactions-modal__backdrop",fullscreen:"sm-down",contentClassName:"wb-modal__container follows",children:[s.jsx(h.Header,{closeButton:!0,children:s.jsx(h.Title,{children:j})}),s.jsxs(h.Body,{className:"overflow-auto",children:[m?s.jsx("p",{className:"text-danger",children:m}):o.map((a,r)=>s.jsx("div",{className:"mb-2",children:s.jsx(O,{ref:r===o.length-1?u:void 0,item:a,showReactions:d})},r)),i&&s.jsx("div",{className:"my-5 text-center",children:s.jsx(S,{})})]})]})};export{R,A as a,L as r};
