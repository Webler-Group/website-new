import{r as a,u as ae,j as e,c as le,B as p,C as _,R as J,a as R,O as ne,b as E,F as re,P as q,d as G,e as K,f as B,g as ie,h as u,i as ce,k as Q,L as z,l as oe,m as de,D as H,E as he,n as W,o as I,p as ue,q as me,I as xe,s as ge,t as je,v as Y,w as A,x as pe,y as fe,z as Ce,A as P,H as ve,G as U}from"./index-ed6a0f8c.js";import{T as $}from"./Toast-1c51cc77.js";import{P as ye}from"./react-bootstrap-pagination-control.esm-13a4037d.js";import{l as V}from"./Code-0398120c.js";import{r as be}from"./roles-68ed67e6.js";import{t as we}from"./StringUtils-91be14c5.js";import{M as Se}from"./PostTextareaControl-ca103577.js";import{u as Ne,C as ke}from"./useEditorOptions-3a97ada4.js";import{M as F}from"./Modal-ceebf9cf.js";import{M as Ee}from"./MdEditorField-d158e9fb.js";import"./PostAttachmentSelect-de3ceb10.js";import"./CodeList-bfed21b2.js";import"./Spinner-67e86fed.js";import"./Tabs-6c3d1c14.js";import"./Tab-3dc5ca70.js";const Te={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},X=a.forwardRef(({bsPrefix:s,position:l,containerPosition:n,className:o,as:d="div",...i},t)=>(s=ae(s,"toast-container"),e.jsx(d,{ref:t,...i,className:le(s,l&&Te[l],n&&`position-${n}`,o)})));X.displayName="ToastContainer";const Le=X,Z=a.createContext(void 0),ee=()=>{const s=a.useContext(Z);if(!s)throw new Error("useSnackbar must be used within SnackbarProvider");return s},Pe=({children:s})=>{const[l,n]=a.useState(null),o=d=>{n(d),setTimeout(()=>n(null),3e3)};return e.jsxs(Z.Provider,{value:{showMessage:o},children:[s,e.jsx(Le,{position:"bottom-end",className:"p-3",children:e.jsx($,{bg:"dark",show:!!l,onClose:()=>n(null),delay:3e3,autohide:!0,children:e.jsx($.Body,{className:"text-white",children:l})})})]})},Fe=({Header:s,Footer:l,SideMenu:n,AsideMenu:o})=>{const[d,i]=a.useState(!1),[t,r]=a.useState(!1);return e.jsx(Pe,{children:e.jsxs("div",{className:"d-flex flex-column min-vh-100",children:[s&&e.jsxs("header",{className:"sticky-top bg-light shadow-sm d-flex align-items-center justify-content-between p-2 bg-warning",children:[s,e.jsxs("div",{className:"d-md-none d-flex gap-2",children:[n&&e.jsx(p,{size:"sm",variant:"outline-primary",onClick:()=>i(!0),children:"Menu"}),o&&e.jsx(p,{size:"sm",variant:"outline-secondary",onClick:()=>r(!0),children:"Info"})]})]}),e.jsx(_,{className:"py-2",children:e.jsxs(J,{children:[n&&e.jsx(R,{xs:12,md:2,className:"bg-light border-end d-none d-md-block",children:n}),e.jsx(R,{xs:12,md:o?8:10,children:e.jsx(ne,{})}),o&&e.jsx(R,{xs:12,md:2,className:"bg-white border-start d-none d-md-block",children:o})]})}),l&&e.jsx("footer",{className:"bg-dark text-white p-3 mt-auto",children:l}),n&&e.jsxs(E,{show:d,onHide:()=>i(!1),responsive:"md",children:[e.jsx(E.Header,{closeButton:!0,children:e.jsx(E.Title,{children:"Menu"})}),e.jsx(E.Body,{children:n})]}),o&&e.jsxs(E,{show:t,onHide:()=>r(!1),responsive:"md",placement:"end",children:[e.jsx(E.Header,{closeButton:!0,children:e.jsx(E.Title,{children:"Info"})}),e.jsx(E.Body,{children:o})]})]})})},se=({challenge:s})=>e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Object.entries(V).filter(([l])=>l!="web").map(([l,n])=>{var o;return e.jsxs("div",{className:"d-flex justify-content-center align-items-center rounded-circle text-light position-relative small",style:{backgroundColor:n.color,width:"32px",height:"32px"},children:[n.shortName,((o=s.submissions)==null?void 0:o.some(d=>d.language===l&&d.passed))&&e.jsx("div",{className:"position-absolute bottom-0 end-0 text-success",style:{transform:"translate(25%, 25%)"},children:e.jsx(re,{})})]},l)})}),De=()=>{q("Code Challenge");const{sendJsonRequest:s}=G(),{userInfo:l}=K(),n=B(),[o,d]=a.useState([]),i=10,[t,r]=a.useState(1),[g,b]=a.useState(0),[w,f]=a.useState(!1),[S,C]=a.useState("all"),[v,x]=a.useState(""),[N,y]=a.useState(""),[m,T]=ie();a.useEffect(()=>{c()},[m]),a.useEffect(()=>{D(1)},[S,status,N]),a.useEffect(()=>{m.has("page")&&r(Number(m.get("page"))),m.has("difficulty")&&C(m.get("difficulty")),m.has("query")&&(y(m.get("query")),x(m.get("query")))},[]);const D=h=>{t!==h&&(m.set("page",h.toString()),T(m,{replace:!0}),r(h))},k=()=>{m.set("query",v),T(m,{replace:!0}),y(v)},c=async()=>{f(!0);const h=await s("/Challenge","POST",{page:m.has("page")?Number(m.get("page")):1,count:i,difficulty:m.has("difficulty")?m.get("difficulty"):null,searchQuery:m.has("query")?m.get("query"):""});h&&h.challenges&&(d(h.challenges),b(h.count)),f(!1)},O=h=>{const j=h.target.selectedOptions[0].value;j=="all"?m.delete("difficulty"):m.set("difficulty",j),T(m,{replace:!0}),C(j)};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(u.Label,{htmlFor:"search",className:"visually-hidden",children:"Search challenges"}),e.jsx(ce,{id:"search",type:"search",size:"sm",placeholder:"Search...",value:v,onChange:h=>x(h.target.value),onKeyDown:h=>{h.key==="Enter"&&(h.preventDefault(),k())}}),e.jsx(p,{size:"sm",onClick:k,children:"Search"})]}),e.jsxs("div",{className:"mt-2 d-sm-flex flex-row-reverse justify-content-between",children:[(l==null?void 0:l.roles.some(h=>["Admin","Creator"].includes(h)))&&e.jsx("div",{className:"mb-2 d-flex justify-content-end",children:e.jsx(Q.LinkContainer,{to:"/Challenge/Create",children:e.jsx(p,{size:"sm",children:"New challenge"})})}),e.jsx("div",{className:"d-flex gap-2 justify-content-between",children:e.jsxs(u.Group,{children:[e.jsx(u.Label,{htmlFor:"difficulty",className:"visually-hidden",children:"Difficulty"}),e.jsxs(u.Select,{id:"difficulty",style:{width:"120px"},size:"sm",value:S,onChange:O,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]})})]}),e.jsx("div",{className:"mt-2",children:w?e.jsx(z,{}):g===0?e.jsx("div",{className:"wb-empty-list",children:e.jsx("h3",{children:"Nothing to show"})}):e.jsx(J,{className:"g-2",children:o.map((h,j)=>e.jsx(R,{xs:12,sm:6,lg:4,children:e.jsxs("div",{className:"shadow-sm border rounded p-2",onClick:()=>n(`/Challenge/${h.id}`),style:{cursor:"pointer"},children:[e.jsx("div",{className:"fw-semibold",children:h.title}),e.jsx("div",{children:e.jsx(oe,{className:`${h.difficulty==="easy"?"bg-success":h.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:h.difficulty})}),e.jsx("div",{className:"mt-2",children:e.jsx(se,{challenge:h})})]})},j))})}),e.jsx("div",{className:"my-3",children:e.jsx(ye,{page:t,between:3,total:g,limit:i,changePage:D,ellipsis:1})})]})},Oe=({challenge:s,language:l,onExit:n})=>{const{sendJsonRequest:o}=G(),[d,i]=a.useState(null),[t,r]=a.useState(""),[g,b]=a.useState(""),[w,f]=a.useState(""),[S,C]=a.useState(!1),[v,x]=a.useState(!1),{editorOptions:N}=Ne(),{showMessage:y}=ee(),[m,T]=a.useState(s.title);a.useEffect(()=>{l&&(T(`${s.title}`),D())},[s.id,l]),a.useEffect(()=>{const j=L=>{const M=navigator.userAgent.includes("Mac");(M&&L.metaKey&&L.key==="s"||!M&&L.ctrlKey&&L.key==="s")&&(L.preventDefault(),k())};return window.addEventListener("keydown",j),()=>{window.removeEventListener("keydown",j)}},[d,t,w,g]);const D=async()=>{C(!0);const j=await o("/Challenge/GetChallengeCode","POST",{challengeId:s.id,language:l});j&&j.code&&(i(j.code),r(j.code.source)),C(!1)},k=async()=>{C(!0);const j=await o("/Challenge/SaveChallengeCode","POST",{challengeId:s.id,language:l,source:t,title:m});j&&j.data?(i(L=>({...L,...j.data})),r(j.data.source),y("Code saved successfully")):y("Code failed to save"),C(!1)},c=()=>{t!=(d==null?void 0:d.source)?x(!0):n()},O=()=>{x(!1),n()},h=async()=>{await k(),O()};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{style:{zIndex:"1060"},backdropClassName:"wb-challenges-editor__exit-modal__backdrop",show:v,onHide:()=>x(!1),centered:!0,children:[e.jsx(F.Header,{closeButton:!0,children:e.jsx(F.Title,{children:"Unsaved Changes"})}),e.jsx(F.Body,{children:"You have unsaved changes. Do you want to save before exiting?"}),e.jsxs(F.Footer,{children:[e.jsx(p,{variant:"secondary",onClick:O,children:"Exit Without Saving"}),e.jsx(p,{variant:"primary",onClick:h,children:"Save and Exit"})]})]}),e.jsx(F,{show:l!==null,onHide:c,fullscreen:!0,className:"p-0 m-0",contentClassName:"h-100",children:e.jsxs(F.Body,{className:"p-0 m-0 d-flex flex-column",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between border-bottom bg-white p-1",style:{height:"44px"},children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(p,{variant:"link",className:"text-secondary",onClick:c,children:e.jsx(de,{})}),e.jsx("h5",{className:"mb-0",children:s.title})]}),e.jsx("div",{children:e.jsxs(H,{children:[e.jsx(H.Toggle,{as:he}),e.jsx(H.Menu,{style:{width:"200px"},children:e.jsx(H.Item,{onClick:k,children:"Save"})})]})})]}),e.jsx("div",{className:"d-flex flex-column flex-grow-1 overflow-hidden",children:d!=null?e.jsx(ke,{code:d,source:t,setSource:r,css:w,setCss:f,js:g,setJs:b,options:N,tabHeightStyle:"calc(100dvh - 85px)",challenge:s,submission:d.lastSubmission}):S?e.jsx("div",{className:"d-flex w-100 h-100 justify-content-center align-items-center",children:e.jsx(z,{})}):e.jsx("p",{children:"Something went wrong"})})]})})]})},He=()=>{const{challengeId:s}=W(),l=B(),{userInfo:n}=K(),{sendJsonRequest:o}=G(),[d,i]=a.useState(!1),[t,r]=a.useState(null),[g,b]=a.useState(""),[w,f]=a.useState(null);a.useEffect(()=>{S()},[s]);const S=async()=>{if(!s)return;i(!0);const x=await o("/Challenge/GetChallenge","POST",{challengeId:s});x&&x.challenge&&r(x.challenge),i(!1)},C=()=>{f(null)},v=x=>{f(x)};return t!=null?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{challenge:t,language:w,onExit:C}),e.jsxs(_,{children:[e.jsxs("div",{className:"d-flex gap-2 py-2",children:[e.jsx(I,{to:"/Challenge",children:"Challenges"}),e.jsx("span",{children:"›"}),e.jsx("span",{children:we(t.title,25)})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:t.title}),e.jsx("span",{className:`badge ${t.difficulty==="easy"?"bg-success":t.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:t.difficulty})]}),(n==null?void 0:n.roles.some(x=>["Admin","Creator"].includes(x)))&&e.jsx(ue,{role:"button",title:"Edit Challenge",onClick:()=>l(`/Challenge/Edit/${t.id}`),className:"text-muted",style:{cursor:"pointer"}})]}),e.jsx(Se,{content:t.description}),e.jsx("div",{className:"mt-2",children:e.jsx(se,{challenge:t})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(me,{className:"fw-semibold",children:"Select language for solution:"}),e.jsxs(xe,{className:"mb-2",size:"sm",style:{maxWidth:"400px"},children:[e.jsxs(ge,{value:g,onChange:x=>b(x.target.value),children:[e.jsx("option",{value:"",children:"-- Select Language --"}),Object.entries(V).filter(([x])=>x!="web").map(([x,N])=>e.jsx("option",{value:x,children:N.displayName},x))]}),e.jsx(p,{variant:"primary",disabled:!g,onClick:()=>v(g),children:"Open Editor"})]})]})]})]}):d?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(z,{})}):e.jsxs("div",{className:"d-flex h-100 py-5 flex-column align-items-center justify-content-center text-center",children:[e.jsx("h4",{children:e.jsx(je,{})}),e.jsx("h5",{children:"Challenge not found"}),e.jsx("div",{children:e.jsx(I,{to:"/Challenge",children:"Go back"})})]})},Re=({testCases:s,setTestCases:l})=>{const n=(i,t,r)=>{const g=[...s];g[i][t]=r,l(g)},o=()=>{l([...s,{input:"",expectedOutput:"",isHidden:!0}])},d=i=>{l(s.filter((t,r)=>r!==i))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Test Cases"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:s.map((i,t)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs("div",{className:"fw-semibold",children:["Test case #",t]}),e.jsxs(u.Group,{children:[e.jsx(u.Label,{htmlFor:"input"+t,children:"Input"}),e.jsx(u.Control,{id:"input"+t,as:"textarea",rows:3,value:i.input,placeholder:"Input",onChange:r=>n(t,"input",r.target.value)})]}),e.jsxs(u.Group,{children:[e.jsx(u.Label,{htmlFor:"expected-output"+t,children:"Expected Output"}),e.jsx(u.Control,{id:"expected-output"+t,as:"textarea",rows:3,value:i.expectedOutput,placeholder:"Expected output",onChange:r=>n(t,"expectedOutput",r.target.value)})]}),e.jsx(u.Check,{type:"checkbox",label:"Hidden?",checked:i.isHidden,onChange:r=>n(t,"isHidden",r.target.checked)}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>d(t),children:[e.jsx(Y,{})," Delete"]})})]},t))}),e.jsxs(p,{variant:"success",onClick:o,className:"m-2",children:[e.jsx(A,{className:"me-2"}),"Add TestCases"]})]})},Ge=({languages:s,setLanguages:l})=>{const n=(i,t,r)=>{const g=[...s];g[i][t]=r,l(g)},o=()=>{l([...s,{name:"",source:""}])},d=i=>{l(s.filter((t,r)=>r!==i))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Templates"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:s.map((i,t)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs(u.Group,{children:[e.jsx(u.Label,{children:"Language"}),e.jsx(u.Control,{type:"text",value:i.name,placeholder:"name",onChange:r=>n(t,"name",r.target.value)})]}),e.jsxs(u.Group,{children:[e.jsx(u.Label,{children:"Source"}),e.jsx(u.Control,{as:"textarea",rows:10,value:i.source,placeholder:"source",onChange:r=>n(t,"source",r.target.value)})]}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>d(t),children:[e.jsx(Y,{})," Delete"]})})]},t))}),e.jsx("div",{className:"mt-2",children:e.jsxs(p,{variant:"success",onClick:o,children:[e.jsx(A,{className:"me-2"}),"Add Template"]})})]})},te=({challengeId:s})=>{const{sendJsonRequest:l}=G(),n=B(),[o,d]=a.useState(""),[i,t]=a.useState("easy"),[r,g]=a.useState(""),[b,w]=a.useState([]),[f,S]=a.useState([]),[C,v]=a.useState(""),{showMessage:x}=ee(),[N,y]=a.useState(!1);a.useEffect(()=>{s&&m()},[s]);const m=async()=>{y(!0);const c=await l("/Challenge/GetUpdatedChallenge","POST",{challengeId:s});c&&c.challenge&&(d(c.challenge.title),g(c.challenge.description),t(c.challenge.difficulty),w(c.challenge.testCases),S(c.challenge.templates)),y(!1)},T=async()=>{const c=await l("/Challenge/Create","POST",{title:o,description:r,difficulty:i,testCases:b,templates:f});c&&c.challenge?(x("Challenge created Successfully"),n("/Challenge/"+c.challenge.id)):v((c==null?void 0:c.error[0].message)??"Something went wrong")},D=async()=>{const c=await l("/Challenge/Update","POST",{challengeId:s,title:o,description:r,difficulty:i,testCases:b,templates:f});c&&c.data?(x("Challenge updated Successfully"),n("/Challenge/"+c.data.id)):v((c==null?void 0:c.error[0].message)??"Something went wrong")},k=async c=>{c.preventDefault(),v(""),y(!0),s?await D():await T(),y(!1)};return e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx(A,{className:"me-2"})," ",s?"Update":"Create"," Challenge"]}),e.jsxs(u,{onSubmit:k,children:[e.jsxs(u.Group,{className:"mb-3",children:[e.jsx(u.Label,{children:"Title"}),e.jsx(u.Control,{type:"text",placeholder:"Enter challenge title",value:o,onChange:c=>d(c.target.value),required:!0})]}),e.jsxs(u.Group,{className:"mb-3",children:[e.jsxs(u.Label,{children:[e.jsx(pe,{className:"me-2"})," Description"]}),e.jsx(Ee,{text:r,setText:g,placeHolder:"Describe the challenge...",row:10,isPost:!1})]}),e.jsx(Re,{testCases:b,setTestCases:w}),e.jsx(Ge,{languages:f,setLanguages:S}),e.jsxs(u.Group,{className:"mb-3",children:[e.jsxs(u.Label,{children:[e.jsx(fe,{className:"me-2"})," Difficulty"]}),e.jsxs(u.Select,{value:i,onChange:c=>t(c.target.value),children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsx("p",{className:"col text-danger",children:C}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(Q.LinkContainer,{to:s?"/Challenge/"+s:"/Challenge",children:e.jsx(p,{type:"button",variant:"secondary",disabled:N,children:"Cancel"})}),e.jsx(p,{type:"submit",variant:"primary",disabled:N,children:s?"Update":"Create"})]})]})]})},qe=()=>(q("Create Challenge"),e.jsx(te,{})),Be=()=>{q("Update Challenge");const{challengeId:s}=W();return e.jsx(te,{challengeId:s})};const ss=()=>e.jsx(Ce,{children:e.jsxs(P,{element:e.jsx(Fe,{Header:e.jsx(ve,{variant:"light"}),Footer:null}),children:[e.jsx(P,{index:!0,element:e.jsx(De,{})}),e.jsx(P,{element:e.jsx(U,{allowedRoles:be}),children:e.jsx(P,{path:":challengeId",element:e.jsx(He,{})})}),e.jsxs(P,{element:e.jsx(U,{allowedRoles:["Admin","Creator"]}),children:[e.jsx(P,{path:"Create",element:e.jsx(qe,{})}),e.jsx(P,{path:"Edit/:challengeId",element:e.jsx(Be,{})})]})]})});export{ss as default};
