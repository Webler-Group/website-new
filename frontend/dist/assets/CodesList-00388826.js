import{g as k,f as A,r as a,u as B,j as t}from"./index-b2f3d98e.js";import{r as M}from"./index-19ddc0d1.js";import{C as D}from"./Code-9b57c986.js";import{P as J}from"./react-bootstrap-pagination-control.esm-59f727af.js";import{Q as K}from"./QuestionPlaceholder-73174a39.js";import{l as T}from"./App-a146ef5c.js";import{F as U}from"./FormControl-a036e454.js";import{B as N}from"./Button-a8db19a8.js";import{F as P}from"./Form-4647d33b.js";import"./index-11ee592c.js";import"./DateUtils-6b83375c.js";import"./index.esm-cb18ecd9.js";import"./iconBase-7a454df3.js";import"./index.esm-4a619d62.js";import"./ProfileAvatar-4b9caa46.js";import"./ThemeProvider-c318c21f.js";import"./Anchor-1fe32030.js";import"./Col-1c3a04d0.js";import"./createWithBsPrefix-c6deafcc.js";const ue=()=>{const{sendJsonRequest:b}=k(),{userInfo:n}=A(),[w,q]=a.useState([]),i=10,[u,d]=a.useState(1),[m,F]=a.useState(0),[E,h]=a.useState(!1),[c,g]=a.useState(1),[Q,p]=a.useState("all"),[f,x]=a.useState(""),[j,v]=a.useState(""),[s,o]=B();a.useEffect(()=>{z()},[s]),a.useEffect(()=>{y(1)},[c,j]),a.useEffect(()=>{s.has("page")&&d(Number(s.get("page"))),s.has("filter")&&g(Number(s.get("filter"))),s.has("query")&&(x(s.get("query")),v(s.get("query"))),s.has("language")&&p(s.get("language"))},[]);const y=e=>{u!==e&&(s.set("page",e.toString()),o(s,{replace:!0}),d(e))},S=()=>{const e=f.trim();s.set("query",e),o(s,{replace:!0}),v(e)},z=async()=>{h(!0);const e=s.has("page")?Number(s.get("page")):1,r=s.has("filter")?Number(s.get("filter")):1,O=s.has("query")?s.get("query"):"",R=s.has("language")?s.get("language"):null,l=await b("/Codes","POST",{page:e,count:i,filter:r,searchQuery:O,language:R,userId:n?n.id:null});l&&l.codes&&(q(l.codes),F(l.count)),h(!1)},I=e=>{const r=Number(e.target.selectedOptions[0].value);s.set("filter",r.toString()),o(s,{replace:!0}),g(r)},L=e=>{const r=e.target.selectedOptions[0].value;r==="all"?s.delete("language"):s.set("language",r),o(s,{replace:!0}),p(r)};let C=[];for(let e=0;e<i;++e)C.push(t.jsx(K,{},e));return t.jsxs("div",{className:"d-flex flex-column",children:[t.jsx("h2",{children:"Codes"}),t.jsxs("div",{className:"d-flex gap-2",children:[t.jsx(U,{type:"search",size:"sm",placeholder:"Search...",value:f,onChange:e=>x(e.target.value),onKeyDown:e=>{e.key==="Enter"&&(e.preventDefault(),S())}}),t.jsx(N,{size:"sm",onClick:S,children:"Search"})]}),t.jsxs("div",{className:"mt-2 d-sm-flex flex-row-reverse justify-content-between",children:[t.jsx("div",{className:"mb-2 mb-sm-0 d-flex justify-content-end",children:t.jsx(M.LinkContainer,{to:"/Compiler-Playground",children:t.jsx(N,{size:"sm",children:"New code"})})}),t.jsxs("div",{className:"d-flex justify-content-between",children:[t.jsxs(P.Select,{size:"sm",style:{width:"140px"},value:c,onChange:I,children:[t.jsx("option",{value:"1",children:"Most Recent"}),t.jsx("option",{value:"2",children:"Most Popular"}),n&&t.jsx(t.Fragment,{children:t.jsx("option",{value:"3",children:"My Codes"})})]}),t.jsxs(P.Select,{size:"sm",style:{width:"140px"},className:"ms-2",value:Q,onChange:L,children:[t.jsx("option",{value:"all",children:"All"},"all"),Object.entries(T).map(e=>t.jsx("option",{value:e[0],children:e[1].displayName},e[0]))]})]})]}),t.jsx("div",{className:"my-3",children:E?C:m==0?t.jsx("div",{className:"wb-discuss-empty-questions",children:t.jsx("h3",{children:"Nothing to show"})}):w.map(e=>t.jsx("div",{className:"mt-2",children:t.jsx(D,{code:e,searchQuery:j,showUserProfile:c!=3})},e.id))}),t.jsx("div",{className:"my-3",children:t.jsx(J,{page:u,between:3,total:m,limit:i,changePage:y,ellipsis:1})})]})};export{ue as default};
