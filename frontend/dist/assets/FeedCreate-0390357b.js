import{r as i,s as b,j as e,d as y,g as N}from"./index-b2f3d98e.js";import{P as F}from"./PostTextareaControl-1be45863.js";import{M as B}from"./MarkdownRenderer-0f98c67a.js";import{R as T}from"./RequestResultAlert-53291c96.js";import{a as P}from"./discussAllowedUrls-4f3044c5.js";import{C as R}from"./Container-aded6eb3.js";import{F as S,a as M}from"./Form-4647d33b.js";import{u as E}from"./useMergedRefs-f5c2a768.js";import{c as G}from"./createChainedFunction-fd08587d.js";import{m as O}from"./Col-1c3a04d0.js";import{T as x,B as A}from"./ToggleButton-0c78b2c4.js";import{B as j}from"./Button-a8db19a8.js";import"./index.esm-cb18ecd9.js";import"./iconBase-7a454df3.js";import"./UserSearch-78852d36.js";import"./ProfileAvatar-4b9caa46.js";import"./ThemeProvider-c318c21f.js";import"./Nav-131532f4.js";import"./DataKey-e12315fd.js";import"./NavContext-f8abb837.js";import"./Anchor-1fe32030.js";import"./FormControl-a036e454.js";import"./index-11ee592c.js";import"./Alert-f0171b20.js";import"./CloseButton-439f23fc.js";import"./divWithClassName-9b80bbe4.js";import"./createWithBsPrefix-c6deafcc.js";const k=i.forwardRef((o,h)=>{const{children:m,type:n="radio",name:d,value:l,onChange:a,vertical:f=!1,...c}=E(o,{value:"onChange"}),u=()=>l==null?[]:[].concat(l),v=(r,s)=>{if(!a)return;const t=u(),p=t.indexOf(r)!==-1;if(n==="radio"){p||a(r,s);return}a(p?t.filter(g=>g!==r):[...t,r],s)};return n!=="radio"||d||b(!1),e.jsx(A,{...c,ref:h,vertical:f,children:O(m,r=>{const s=u(),{value:t,onChange:p}=r.props,g=C=>v(t,C);return i.cloneElement(r,{type:n,name:r.name||d,checked:s.indexOf(t)!==-1,onChange:G(p,g)})})})}),q=Object.assign(k,{Button:x}),w=4096,ce=()=>{const[o,h]=i.useState(""),[m,n]=i.useState(!1),[d,l]=i.useState(),[a,f]=i.useState("write"),c=y(),{sendJsonRequest:u}=N(),v=async s=>{if(s.preventDefault(),!o.trim())return;n(!0),l(void 0);const t=await u("/Feed/CreateFeed","POST",{message:o});t.success?c("/Feed/"+t.feed.id):l(t.error),n(!1)},r=()=>{c("/Feed")};return e.jsxs(R,{className:"min-vh-100",children:[e.jsx("h2",{className:"fw-semibold my-3",children:"Create New Post"}),e.jsxs(S,{onSubmit:v,children:[e.jsx(T,{errors:d}),e.jsx("div",{className:"mb-3",children:e.jsxs(q,{type:"radio",name:"editorMode",value:a,onChange:s=>f(s),children:[e.jsx(x,{id:"write-btn",value:"write",variant:"outline-primary",children:"Write"}),e.jsx(x,{id:"preview-btn",value:"preview",variant:"outline-primary",children:"Preview"})]})}),a==="write"&&e.jsxs(M,{className:"mb-3",children:[e.jsx(F,{rows:10,placeholder:"What's on your mind?",value:o,setValue:h,required:!0,maxLength:w}),e.jsxs("div",{className:"mt-2 text-muted small",children:[o.length,"/",w," characters"]})]}),a==="preview"&&e.jsx("div",{className:"p-3 border rounded bg-light",children:e.jsx("div",{className:"wb-feed-content__message",children:e.jsx(B,{content:o,allowedUrls:P})})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(j,{type:"button",variant:"secondary",onClick:r,disabled:m,children:"Cancel"}),e.jsx(j,{type:"submit",variant:"primary",disabled:!o.trim()||m,children:"Post"})]})]})]})};export{ce as default};
