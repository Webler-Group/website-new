import{g as H,d as _,r,j as e}from"./index-c193dc40.js";import{r as J}from"./index-99a242c6.js";import{T as K}from"./ToggleSwitch-2a26cb51.js";import{R as T}from"./RequestResultAlert-5538ea88.js";import{M as d}from"./Modal-261a0993.js";import{B as i}from"./Button-b8db3fe4.js";import{F as q,a as u,b as m}from"./Form-19731f2f.js";import{F as g}from"./FormControl-cc700203.js";import"./index-3b750fb9.js";import"./Alert-e497ba45.js";import"./ThemeProvider-ec2a0fef.js";import"./useMergedRefs-2ac3001c.js";import"./Anchor-22c8f756.js";import"./CloseButton-710dc957.js";import"./divWithClassName-a88e1404.js";import"./createWithBsPrefix-6b62a92d.js";import"./useWindow-822d8a97.js";import"./AbstractModalHeader-72c903dd.js";import"./DataKey-e12315fd.js";import"./Col-6d72f785.js";const xe=({courseId:t})=>{const{sendJsonRequest:l}=H(),f=_(),[n,o]=r.useState(!1),[x,y]=r.useState(""),[p,b]=r.useState(""),[h,S]=r.useState(""),[j,E]=r.useState(!1),[z,c]=r.useState(),[R,N]=r.useState(""),[k,w]=r.useState(!1),[F,D]=r.useState(null),[B,L]=r.useState(null),[M,C]=r.useState({});r.useEffect(()=>{t&&U()},[t]);const U=async()=>{o(!0);const s=await l("/CourseEditor/GetCourse","POST",{courseId:t});s&&s.course&&(y(s.course.code),b(s.course.title),S(s.course.description),E(s.course.visible),D(s.course.coverImage)),o(!1)},P=async s=>{s.preventDefault(),o(!0),t?await I():await A(),o(!1)},A=async()=>{c(void 0);const s=await l("/CourseEditor/CreateCourse","POST",{code:x,title:p,description:h,visible:j});s&&s.course?f("/Courses/Editor"):c(s.error)},I=async()=>{c(void 0),N("");const s=await l("/CourseEditor/EditCourse","PUT",{courseId:t,title:p,code:x,description:h,visible:j});s&&s.success?N("Course edited successfully"):c(s.error)},v=()=>{w(!1)},O=async()=>{o(!0);const s=await l("/CourseEditor/DeleteCourse","DELETE",{courseId:t});s&&s.success?(v(),f("/Courses/Editor")):c(s!=null&&s.error?s.error.message:s.message),o(!1)},V=async s=>{s.preventDefault(),C({}),o(!0);const a=await l("/CourseEditor/UploadCourseCoverImage","POST",{courseId:t,coverImage:B},{},!0);a&&a.success?(D(a.data.coverImage),C({message:"Course cover image updated successfully"})):C({errors:a==null?void 0:a.error}),o(!1)},G=s=>{const a=s.target.files;a&&L(a[0])};return e.jsxs(e.Fragment,{children:[e.jsxs(d,{show:k,onHide:v,centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Are you sure?"})}),e.jsx(d.Body,{children:"Course will be permanently deleted."}),e.jsxs(d.Footer,{children:[e.jsx(i,{variant:"secondary",onClick:v,children:"Cancel"}),e.jsx(i,{variant:"danger",onClick:O,children:"Delete"})]})]}),e.jsxs("div",{className:"row",children:[t!==null&&e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx("div",{className:"rounded-circle",children:e.jsx("img",{className:"wb-courses-course__cover-image",src:F?"/uploads/courses/"+F:"/resources/images/logoicon.svg"})})}),e.jsxs(q,{onSubmit:V,children:[e.jsx(T,{errors:M.errors,message:M.message}),e.jsxs(u,{children:[e.jsx(m,{children:"Cover image"}),e.jsx(g,{size:"sm",type:"file",required:!0,onChange:G,accept:"image/png"})]}),e.jsx("div",{className:"d-flex justify-content-end mt-2",children:e.jsx(i,{size:"sm",className:"ms-2",variant:"primary",type:"submit",disabled:n,children:"Upload"})})]})]}),e.jsx("div",{className:"col-12 col-md-8",children:e.jsxs(q,{onSubmit:P,children:[e.jsx(T,{errors:z,message:R}),e.jsxs(u,{children:[e.jsx(m,{children:"Course title"}),e.jsx(g,{type:"text",required:!0,value:p,onChange:s=>b(s.target.value)})]}),e.jsxs(u,{children:[e.jsx(m,{children:"Course code"}),e.jsx(g,{type:"text",required:!0,value:x,onChange:s=>y(s.target.value)})]}),e.jsxs(u,{children:[e.jsx(m,{children:"Course description"}),e.jsx(g,{as:"textarea",rows:8,maxLength:1e3,required:!0,value:h,onChange:s=>S(s.target.value)})]}),e.jsxs(u,{className:"d-flex align-items-center mt-2 gap-2",children:[e.jsx(m,{children:"Is visible"}),e.jsx(K,{value:j,onChange:s=>E(s.target.checked)})]}),e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx(J.LinkContainer,{to:"/Courses/Editor",children:e.jsx(i,{size:"sm",type:"button",variant:"secondary",disabled:n,children:"Cancel"})}),t?e.jsxs(e.Fragment,{children:[e.jsx(i,{size:"sm",variant:"secondary",className:"ms-2",type:"button",onClick:()=>w(!0),disabled:n,children:"Delete"}),e.jsx(i,{size:"sm",variant:"primary",className:"ms-2",type:"submit",disabled:n,children:"Save changes"})]}):e.jsx(e.Fragment,{children:e.jsx(i,{size:"sm",className:"ms-2",variant:"primary",type:"submit",disabled:n,children:"Create course"})})]})]})})]})]})};export{xe as default};
