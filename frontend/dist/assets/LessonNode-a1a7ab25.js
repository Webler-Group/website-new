import{r as c,g as T,j as n}from"./index-c193dc40.js";import{M as E}from"./MarkdownRenderer-9f88d60a.js";import{F as L}from"./Form-19731f2f.js";import{F as M}from"./FormControl-cc700203.js";import{B as a}from"./Button-b8db3fe4.js";const O=[/^https?:\/\/.+/i],J=({nodeId:d,mock:x,onAnswered:y,onContinue:C,onEnter:j})=>{const[e,g]=c.useState(null),[o,i]=c.useState([]),[u,m]=c.useState(""),[r,p]=c.useState(null),{sendJsonRequest:h}=T();c.useEffect(()=>{i([]),m(""),p(null),N()},[d]);const N=async()=>{const s=await h("/Courses/GetLessonNode","POST",{nodeId:d,mock:x});s&&s.lessonNode&&(g(s.lessonNode),j(d))},A=s=>{r===null&&i([s])},v=s=>{if(r!==null)return;let t=[...o];t.includes(s)?t=t.filter(l=>l!==s):t.push(s),i(t)},S=s=>{m(s)},b=async()=>{if(!e)return;let s={nodeId:e.id,mock:x};e.type===2||e.type===3?s.answers=e.answers.map(l=>({id:l.id,correct:o.includes(l.id)})):e.type===4&&(s.correctAnswer=u);const t=await h("/Courses/SolveNode","POST",s);t&&t.success&&(p(t.data.correct),y(e.id,t.data.correct))},k=()=>{i([]),p(null)},f=()=>{e&&C(e.id)},F=s=>o.includes(s)?r===null?"selected":r?"selected correct":"selected incorrect":"initial";let w=n.jsx(n.Fragment,{});if(e){const s=()=>e.answers.map((t,l)=>n.jsx("div",{className:`wb-course-lesson-answer p-2 mt-3 ${F(t.id)}`,role:"button",onClick:()=>{e.type===2?A(t.id):v(t.id)},children:n.jsx("div",{className:"card-body",children:t.text})},l));w=n.jsxs(L,{className:"h-100 d-flex flex-column",children:[n.jsxs("div",{className:"wb-lesson-node-question p-2 flex-grow-1",children:[n.jsx(E,{content:e.text,allowedUrls:O}),e.type===2||e.type===3?s():e.type===4?n.jsx("div",{className:"d-flex justify-content-center",children:n.jsx(M,{className:"wb-course-lesson-answer p-2"+(r===null?"":r?" correct":" incorrect"),style:{width:"120px"},value:u,readOnly:r!==null,onChange:t=>S(t.target.value)})}):null]}),n.jsx("div",{className:"text-center bg-light p-3",children:e.type==1?n.jsx(a,{variant:"success",onClick:f,children:"Continue"}):n.jsx(n.Fragment,{children:r===!0?n.jsx(a,{variant:"success",onClick:f,children:"Continue"}):r===!1?n.jsx(a,{variant:"danger",onClick:k,children:"Try Again"}):n.jsx(a,{variant:"primary",onClick:b,disabled:e.type===4&&u.trim()===""||(e.type===2||e.type===3)&&o.length===0,children:"Check"})})})]})}return w};export{J as L};
