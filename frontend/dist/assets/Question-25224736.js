import{j as e,p as D,w as I,u as C,r as l,F as R,B as F,R as B,a3 as E,an as L,aD as A,D as S,c as W,P as z}from"./index-d1d5899f.js";const k=({name:s,state:i,className:d,onClick:c})=>{const r=()=>{typeof c=="function"&&c()},x="bg-secondary-subtle text-secondary d-inline-flex align-items-center gap-1 "+(d??"");return e.jsxs(D,{className:x,style:{cursor:"default",padding:"0.4rem 0.6rem"},children:[e.jsx("span",{children:s}),i==="cancellable"&&e.jsx("button",{className:"d-flex align-items-center justify-content-center text-danger fw-bold",onClick:r,style:{outline:"none",background:"none",border:"none",fontSize:"1.1rem",lineHeight:1,cursor:"pointer"},children:e.jsx(I,{})})]})},H=({query:s,placeholder:i="Search...",maxWidthPx:d=360,handleSearch:c,size:r,id:x})=>{const{sendJsonRequest:h}=C(),[o,v]=l.useState([]),[u,p]=l.useState(s),[g,w]=l.useState([]),[y,b]=l.useState(!1),t=l.useRef(null);l.useEffect(()=>{a()},[]),l.useEffect(()=>{p(s)},[s]),l.useEffect(()=>{w(m(u,o))},[u,o]);const a=async()=>{const n=await h("/Tag","POST");if(n){const f=n.map(j=>j.name);v(f)}},m=(n,f)=>{const j=n.trim();return j.length===0?f.slice(0,10):f.filter(T=>T.toLowerCase().startsWith(j.toLowerCase())&&T.toLowerCase()!==j.toLowerCase()).slice(0,10)},N=n=>{p(n)};return e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("div",{className:"position-relative",style:{width:"100%"},children:[e.jsx(R,{id:x,ref:t,type:"search",size:r,placeholder:i,value:u,onChange:n=>p(n.target.value),onFocus:()=>b(!0),onBlur:()=>b(!1),style:{width:"100%"},"aria-autocomplete":"list","aria-expanded":g.length>0,onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),c(u),t.current&&t.current.blur())}}),y&&g.length>0&&e.jsx("ul",{className:"position-absolute list-unstyled m-0 p-1",style:{top:"100%",left:0,zIndex:1e3,background:"white",border:"1px solid #ccc",borderRadius:"0.25rem",maxHeight:"150px",overflowY:"auto",width:`min(100%, ${d}px)`,boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},role:"listbox",children:g.map(n=>e.jsx("li",{style:{cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},onClick:()=>N(n),onMouseDown:f=>f.preventDefault(),className:"hover-bg-light",role:"option","aria-selected":!1,children:n},`filtered-tag-${n}`))})]}),e.jsx(F,{size:r,onClick:()=>c(u),children:"Search"})]})},V=({values:s,setValues:i,placeholder:d,id:c})=>{const[r,x]=l.useState(""),[h,o]=l.useState([]),[v,u]=l.useState([]),{sendJsonRequest:p}=C();l.useEffect(()=>{g()},[]);const g=async()=>{const t=await p("/Tag","POST");if(t){const a=t.map(m=>m.name);u(a)}},w=t=>{const a=t.target.value.toLowerCase().trim();x(a),a.length>0?o(v.filter(m=>m.startsWith(a)&&!s.includes(m)).slice(0,10)):o([])},y=t=>{s.length>=10||(i(a=>a.includes(t)?[...a]:[...a,t]),x(""),o([]))};let b=s.map(t=>{const a=()=>{i(m=>m.filter(N=>N!==t))};return e.jsx(k,{name:t,state:"cancellable",onClick:a},t)});return e.jsxs("div",{className:"d-flex flex-wrap align-items-center position-relative",style:{minWidth:"200px",gap:"0.25rem"},children:[b,s.length<10&&e.jsxs("div",{className:"d-flex position-relative",children:[e.jsx(R,{id:c,type:"text",size:"sm",style:{width:"120px",marginLeft:s.length>0?"0.25rem":"0"},value:r,onChange:t=>w(t),placeholder:d}),h.length>0&&r.length>0&&e.jsx("ul",{className:"position-absolute list-unstyled m-0 p-1",style:{top:"100%",left:0,zIndex:1e3,background:"white",border:"1px solid #ccc",borderRadius:"0.25rem",maxHeight:"150px",overflowY:"auto",width:"150px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:h.map(t=>e.jsx("li",{style:{cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},onClick:()=>y(t),onMouseDown:a=>a.preventDefault(),className:"hover-bg-light",children:t},"filtered-tag-"+t))})]})]})},J=B.forwardRef(({question:s,showUserProfile:i},d)=>{let c=s.title,r=e.jsxs("div",{className:"py-2 border-bottom mb-2 bg-white d-md-flex",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx(E,{to:"/Discuss/"+s.id,children:e.jsx("b",{style:{wordBreak:"break-word"},children:c})}),e.jsx("div",{className:"d-flex flex-wrap mt-2",children:s.tags.map((h,o)=>e.jsx(k,{name:h,state:"neutral",className:"me-2"},o))}),e.jsxs("div",{className:"d-flex small mt-2 gap-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(L,{}),e.jsx("span",{className:"ms-1",children:s.votes})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(A,{}),e.jsx("span",{className:"ms-1",children:s.answers})]}),i===!1&&e.jsx("div",{children:e.jsx("span",{className:"text-secondary",children:S.format2(new Date(s.date))})})]})]}),i&&e.jsx("div",{className:"d-flex justify-content-end align-items-end mt-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{children:[e.jsx("div",{children:e.jsx("small",{className:"text-secondary",children:S.format(new Date(s.date))})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(W,{userId:s.userId,userName:s.userName})})]}),e.jsx("div",{className:"ms-2",children:e.jsx(z,{size:32,avatarImage:s.userAvatar})})]})})]});return d?e.jsx("div",{ref:d,children:r}):e.jsx("div",{children:r})});export{V as I,J as Q,H as T,k as W};
