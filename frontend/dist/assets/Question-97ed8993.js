import{j as e,p as k,w as D,u as C,r as l,F as S,B as I,R as F,a2 as B,am as E,aC as L,D as T,c as A,P as W}from"./index-6cb5912a.js";const R=({name:s,state:c,className:d,onClick:r})=>{const i=()=>{typeof r=="function"&&r()},x="bg-secondary-subtle text-secondary d-inline-flex align-items-center gap-1 "+(d??"");return e.jsxs(k,{className:x,style:{cursor:"default",padding:"0.4rem 0.6rem"},children:[e.jsx("span",{children:s}),c==="cancellable"&&e.jsx("button",{className:"d-flex align-items-center justify-content-center text-danger fw-bold",onClick:i,style:{outline:"none",background:"none",border:"none",fontSize:"1.1rem",lineHeight:1,cursor:"pointer"},children:e.jsx(D,{})})]})},P=({query:s,placeholder:c="Search...",maxWidthPx:d=360,handleSearch:r,size:i})=>{const{sendJsonRequest:x}=C(),[o,f]=l.useState([]),[u,p]=l.useState(s),[g,v]=l.useState([]),[w,b]=l.useState(!1),t=l.useRef(null);l.useEffect(()=>{a()},[]),l.useEffect(()=>{p(s)},[s]),l.useEffect(()=>{v(m(u,o))},[u,o]);const a=async()=>{const n=await x("/Tag","POST");if(n){const h=n.map(j=>j.name);f(h)}},m=(n,h)=>{const j=n.trim();return j.length===0?h.slice(0,10):h.filter(N=>N.toLowerCase().startsWith(j.toLowerCase())&&N.toLowerCase()!==j.toLowerCase()).slice(0,10)},y=n=>{p(n)};return e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("div",{className:"position-relative",style:{width:"100%"},children:[e.jsx(S,{ref:t,type:"search",size:i,placeholder:c,value:u,onChange:n=>p(n.target.value),onFocus:()=>b(!0),onBlur:()=>b(!1),style:{width:"100%"},"aria-autocomplete":"list","aria-expanded":g.length>0,onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),r(u),t.current&&t.current.blur())}}),w&&g.length>0&&e.jsx("ul",{className:"position-absolute list-unstyled m-0 p-1",style:{top:"100%",left:0,zIndex:1e3,background:"white",border:"1px solid #ccc",borderRadius:"0.25rem",maxHeight:"150px",overflowY:"auto",width:`min(100%, ${d}px)`,boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},role:"listbox",children:g.map(n=>e.jsx("li",{style:{cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},onClick:()=>y(n),onMouseDown:h=>h.preventDefault(),className:"hover-bg-light",role:"option","aria-selected":!1,children:n},`filtered-tag-${n}`))})]}),e.jsx(I,{size:i,onClick:()=>r(u),children:"Search"})]})},H=({values:s,setValues:c,placeholder:d})=>{const[r,i]=l.useState(""),[x,o]=l.useState([]),[f,u]=l.useState([]),{sendJsonRequest:p}=C();l.useEffect(()=>{g()},[]);const g=async()=>{const t=await p("/Tag","POST");if(t){const a=t.map(m=>m.name);u(a)}},v=t=>{const a=t.target.value.toLowerCase().trim();i(a),a.length>0?o(f.filter(m=>m.startsWith(a)&&!s.includes(m)).slice(0,10)):o([])},w=t=>{s.length>=10||(c(a=>a.includes(t)?[...a]:[...a,t]),i(""),o([]))};let b=s.map(t=>{const a=()=>{c(m=>m.filter(y=>y!==t))};return e.jsx(R,{name:t,state:"cancellable",onClick:a},t)});return e.jsxs("div",{className:"d-flex flex-wrap align-items-center position-relative",style:{minWidth:"200px",gap:"0.25rem"},children:[b,s.length<10&&e.jsxs("div",{className:"d-flex position-relative",children:[e.jsx(S,{type:"text",size:"sm",style:{width:"120px",marginLeft:s.length>0?"0.25rem":"0"},value:r,onChange:t=>v(t),placeholder:d}),x.length>0&&r.length>0&&e.jsx("ul",{className:"position-absolute list-unstyled m-0 p-1",style:{top:"100%",left:0,zIndex:1e3,background:"white",border:"1px solid #ccc",borderRadius:"0.25rem",maxHeight:"150px",overflowY:"auto",width:"150px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:x.map(t=>e.jsx("li",{style:{cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"},onClick:()=>w(t),onMouseDown:a=>a.preventDefault(),className:"hover-bg-light",children:t},"filtered-tag-"+t))})]})]})},V=F.forwardRef(({question:s,showUserProfile:c},d)=>{let r=s.title,i=e.jsxs("div",{className:"py-2 border-bottom mb-2 bg-white d-md-flex",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx(B,{to:"/Discuss/"+s.id,children:e.jsx("b",{style:{wordBreak:"break-word"},children:r})}),e.jsx("div",{className:"d-flex flex-wrap mt-2",children:s.tags.map((o,f)=>e.jsx(R,{name:o,state:"neutral",className:"me-2"},f))}),e.jsxs("div",{className:"d-flex small mt-2 gap-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(E,{}),e.jsx("span",{className:"ms-1",children:s.votes})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(L,{}),e.jsx("span",{className:"ms-1",children:s.answers})]}),c===!1&&e.jsx("div",{children:e.jsx("span",{className:"text-secondary",children:T.format2(new Date(s.date))})})]})]}),c&&e.jsx("div",{className:"d-flex justify-content-end align-items-end mt-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{children:[e.jsx("div",{children:e.jsx("small",{className:"text-secondary",children:T.format(new Date(s.date))})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(A,{userId:s.userId,userName:s.userName})})]}),e.jsx("div",{className:"ms-2",children:e.jsx(W,{size:32,avatarImage:s.userAvatar})})]})})]});return d?e.jsx("div",{ref:d,children:i}):e.jsx("div",{children:i})});export{H as I,V as Q,P as T,R as W};
