import{g as p,r as o,R as w,f as N,j as s,L as I}from"./index-b2f3d98e.js";import{P as v}from"./ProfileAvatar-4b9caa46.js";import{P as S}from"./DateUtils-6b83375c.js";import{M as g}from"./Modal-d6b02714.js";const y=(e,u)=>{const{sendJsonRequest:x}=p(),[m,d]=o.useState([]),[c,l]=o.useState(!1),[i,n]=o.useState(!0),[j,b]=o.useState(),[t,f]=o.useState({page:1});return o.useEffect(()=>{(async()=>{if(t.page==0||!e.parentId)return;b(void 0),l(!0);const r=await x("/Feed/GetUserReactions","POST",{parentId:e.parentId,page:t.page,count:u});r&&r.userReactions?(d(h=>t.page==1?r.userReactions:[...h,...r.userReactions]),n(r.userReactions.length===u)):b(r.error),l(!1)})()},[t]),o.useEffect(()=>{d([]),f({page:1})},[e]),{results:m,loading:c,hasNextPage:i,error:j,setState:f}};var A=(e=>(e[e.LIKE=1]="LIKE",e[e.HAHA=2]="HAHA",e[e.ANGRY=3]="ANGRY",e[e.LOVE=4]="LOVE",e[e.SAD=5]="SAD",e[e.WOW=6]="WOW",e))(A||{});const L={1:{emoji:"👍",label:"Like",color:"#1877f2"},4:{emoji:"❤️",label:"Love",color:"#e91e63"},2:{emoji:"😂",label:"Haha",color:"#f39c12"},6:{emoji:"😮",label:"Wow",color:"#f39c12"},5:{emoji:"😢",label:"Sad",color:"#f39c12"},3:{emoji:"😡",label:"Angry",color:"#e74c3c"}},P=w.forwardRef(({item:e,showReactions:u},x)=>{const{sendJsonRequest:m}=p(),[d,c]=o.useState(!1),[l,i]=o.useState(e.isFollowing),{userInfo:n}=N(),j=async()=>{if(!n)return;c(!0);const a=await m("/Profile/Follow","POST",{userId:e.userId});a&&a.success&&i(!0),c(!1)},b=async()=>{if(!n)return;c(!0);const a=await m("/Profile/Unfollow","POST",{userId:e.userId});a&&a.success&&i(!1),c(!1)},t=L[e.reaction],f=s.jsxs("div",{className:"d-flex justify-content-between align-items-start py-2 border-bottom",children:[s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("div",{className:"me-2",children:s.jsx(v,{size:42,avatarImage:e.userAvatar??null})}),s.jsxs("div",{className:"d-flex flex-column",children:[s.jsx(S,{userId:e.userId,userName:e.userName}),u&&s.jsxs("div",{className:"mt-1 d-flex align-items-center",title:t.label,children:[s.jsx("span",{className:"me-1",children:t.emoji}),s.jsx("span",{style:{fontSize:"15px",color:t.color,fontWeight:600},children:t.label})]})]})]}),n&&n.id!==e.userId&&(l?s.jsx("button",{className:"btn btn-outline-secondary btn-sm",disabled:d,onClick:b,children:"Unfollow"}):s.jsx("button",{className:"btn btn-primary btn-sm",disabled:d,onClick:j,children:"Follow"}))]});return x?s.jsx("div",{ref:x,children:f}):s.jsx("div",{children:f})}),k=({options:e,visible:u,onClose:x,title:m,showReactions:d,countPerPage:c})=>{const{results:l,loading:i,hasNextPage:n,error:j,setState:b}=y(e,c),t=o.useRef(),f=o.useCallback(a=>{i||(t.current&&t.current.disconnect(),t.current=new IntersectionObserver(r=>{r[0].isIntersecting&&n&&l.length>0&&b(h=>({page:h.page+1}))}),a&&t.current.observe(a))},[i,n,l]);return s.jsxs(g,{show:u,onHide:x,className:"d-flex justify-content-center align-items-center",style:{zIndex:1070},backdropClassName:"wb-reactions-modal__backdrop",fullscreen:"sm-down",contentClassName:"wb-modal__container follows",children:[s.jsx(g.Header,{closeButton:!0,children:s.jsx(g.Title,{children:m})}),s.jsxs(g.Body,{className:"overflow-auto",children:[j?s.jsx("p",{className:"text-danger",children:j}):l.map((a,r)=>s.jsx("div",{className:"mb-2",children:s.jsx(P,{ref:r===l.length-1?f:void 0,item:a,showReactions:d})},r)),i&&s.jsx(I,{})]})]})};export{k as R,A as a,L as r};
