import{r as l,u as se,j as e,c as te,B as p,C as U,R as _,a as H,O as ae,b as L,F as le,P as G,d as R,e as $,f as q,g as ne,h as u,i as re,k as J,L as B,l as ie,m as ce,D as O,E as oe,n as K,o as A,p as de,q as he,I as ue,s as me,t as xe,v as Q,w as z,x as ge,y as je,z as pe,A as F,H as fe,G as M}from"./index-80db11cf.js";import{T as I}from"./Toast-6154fa82.js";import{P as Ce}from"./react-bootstrap-pagination-control.esm-b45f6320.js";import{l as W}from"./Code-d9d12e4f.js";import{r as ve}from"./roles-68ed67e6.js";import{t as ye}from"./StringUtils-91be14c5.js";import{M as be}from"./PostTextareaControl-3c30086b.js";import{u as we,C as Se}from"./useEditorOptions-435b9d0f.js";import{M as D}from"./Modal-19ce6b28.js";import{M as Ne}from"./MdEditorField-3b4133e9.js";import"./PostAttachmentSelect-8cd57bbf.js";import"./CodeList-7b842335.js";import"./Spinner-9b064ee8.js";import"./Tabs-a00605ec.js";import"./Tab-6c7e38c4.js";const ke={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},Y=l.forwardRef(({bsPrefix:s,position:a,containerPosition:n,className:d,as:h="div",...i},t)=>(s=se(s,"toast-container"),e.jsx(h,{ref:t,...i,className:te(s,a&&ke[a],n&&`position-${n}`,d)})));Y.displayName="ToastContainer";const Ee=Y,V=l.createContext(void 0),X=()=>{const s=l.useContext(V);if(!s)throw new Error("useSnackbar must be used within SnackbarProvider");return s},Le=({children:s})=>{const[a,n]=l.useState(null),d=h=>{n(h),setTimeout(()=>n(null),3e3)};return e.jsxs(V.Provider,{value:{showMessage:d},children:[s,e.jsx(Ee,{position:"bottom-end",className:"p-3",children:e.jsx(I,{bg:"dark",show:!!a,onClose:()=>n(null),delay:3e3,autohide:!0,children:e.jsx(I.Body,{className:"text-white",children:a})})})]})},Te=({Header:s,Footer:a,SideMenu:n,AsideMenu:d})=>{const[h,i]=l.useState(!1),[t,r]=l.useState(!1);return e.jsx(Le,{children:e.jsxs("div",{className:"d-flex flex-column min-vh-100",children:[s&&e.jsxs("header",{className:"sticky-top bg-light shadow-sm d-flex align-items-center justify-content-between p-2 bg-warning",children:[s,e.jsxs("div",{className:"d-md-none d-flex gap-2",children:[n&&e.jsx(p,{size:"sm",variant:"outline-primary",onClick:()=>i(!0),children:"Menu"}),d&&e.jsx(p,{size:"sm",variant:"outline-secondary",onClick:()=>r(!0),children:"Info"})]})]}),e.jsx(U,{className:"py-2",children:e.jsxs(_,{children:[n&&e.jsx(H,{xs:12,md:2,className:"bg-light border-end d-none d-md-block",children:n}),e.jsx(H,{xs:12,md:d?8:10,children:e.jsx(ae,{})}),d&&e.jsx(H,{xs:12,md:2,className:"bg-white border-start d-none d-md-block",children:d})]})}),a&&e.jsx("footer",{className:"bg-dark text-white p-3 mt-auto",children:a}),n&&e.jsxs(L,{show:h,onHide:()=>i(!1),responsive:"md",children:[e.jsx(L.Header,{closeButton:!0,children:e.jsx(L.Title,{children:"Menu"})}),e.jsx(L.Body,{children:n})]}),d&&e.jsxs(L,{show:t,onHide:()=>r(!1),responsive:"md",placement:"end",children:[e.jsx(L.Header,{closeButton:!0,children:e.jsx(L.Title,{children:"Info"})}),e.jsx(L.Body,{children:d})]})]})})},Z=({challenge:s})=>e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Object.entries(W).filter(([a])=>a!="web").map(([a,n])=>{var d;return e.jsxs("div",{className:"d-flex justify-content-center align-items-center rounded-circle text-light position-relative small",style:{backgroundColor:n.color,width:"32px",height:"32px"},children:[n.shortName,((d=s.submissions)==null?void 0:d.some(h=>h.language===a&&h.passed))&&e.jsx("div",{className:"position-absolute bottom-0 end-0 text-success",style:{transform:"translate(25%, 25%)"},children:e.jsx(le,{})})]},a)})}),Pe=()=>{G("Code Challenge");const{sendJsonRequest:s}=R(),{userInfo:a}=$(),n=q(),[d,h]=l.useState([]),i=10,[t,r]=l.useState(1),[g,b]=l.useState(0),[w,f]=l.useState(!1),[S,C]=l.useState("all"),[v,x]=l.useState(""),[k,y]=l.useState(""),[m,N]=ne();l.useEffect(()=>{o()},[m]),l.useEffect(()=>{T(1)},[S,status,k]),l.useEffect(()=>{m.has("page")&&r(Number(m.get("page"))),m.has("difficulty")&&C(m.get("difficulty")),m.has("query")&&(y(m.get("query")),x(m.get("query")))},[]);const T=c=>{t!==c&&(m.set("page",c.toString()),N(m,{replace:!0}),r(c))},P=()=>{m.set("query",v),N(m,{replace:!0}),y(v)},o=async()=>{f(!0);const c=await s("/Challenge","POST",{page:m.has("page")?Number(m.get("page")):1,count:i,difficulty:m.has("difficulty")?m.get("difficulty"):null,searchQuery:m.has("query")?m.get("query"):""});c&&c.challenges&&(h(c.challenges),b(c.count)),f(!1)},j=c=>{const E=c.target.selectedOptions[0].value;E=="all"?m.delete("difficulty"):m.set("difficulty",E),N(m,{replace:!0}),C(E)};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(u.Label,{htmlFor:"search",className:"visually-hidden",children:"Search challenges"}),e.jsx(re,{id:"search",type:"search",size:"sm",placeholder:"Search...",value:v,onChange:c=>x(c.target.value),onKeyDown:c=>{c.key==="Enter"&&(c.preventDefault(),P())}}),e.jsx(p,{size:"sm",onClick:P,children:"Search"})]}),e.jsxs("div",{className:"mt-2 d-sm-flex flex-row-reverse justify-content-between",children:[(a==null?void 0:a.roles.some(c=>["Admin","Creator"].includes(c)))&&e.jsx("div",{className:"mb-2 d-flex justify-content-end",children:e.jsx(J.LinkContainer,{to:"/Challenge/Create",children:e.jsx(p,{size:"sm",children:"New challenge"})})}),e.jsx("div",{className:"d-flex gap-2 justify-content-between",children:e.jsxs(u.Group,{children:[e.jsx(u.Label,{htmlFor:"difficulty",className:"visually-hidden",children:"Difficulty"}),e.jsxs(u.Select,{id:"difficulty",style:{width:"120px"},size:"sm",value:S,onChange:j,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]})})]}),e.jsx("div",{className:"mt-2",children:w?e.jsx(B,{}):g===0?e.jsx("div",{className:"wb-empty-list",children:e.jsx("h3",{children:"Nothing to show"})}):e.jsx(_,{className:"g-2",children:d.map((c,E)=>e.jsx(H,{xs:12,sm:6,lg:4,children:e.jsxs("div",{className:"shadow-sm border rounded p-2",onClick:()=>n(`/Challenge/${c.id}`),style:{cursor:"pointer"},children:[e.jsx("div",{className:"fw-semibold",children:c.title}),e.jsx("div",{children:e.jsx(ie,{className:`${c.difficulty==="easy"?"bg-success":c.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:c.difficulty})}),e.jsx("div",{className:"mt-2",children:e.jsx(Z,{challenge:c})})]})},E))})}),e.jsx("div",{className:"my-3",children:e.jsx(Ce,{page:t,between:3,total:g,limit:i,changePage:T,ellipsis:1})})]})},Fe=({challenge:s,language:a,onExit:n})=>{const{sendJsonRequest:d}=R(),[h,i]=l.useState(null),[t,r]=l.useState(""),[g,b]=l.useState(""),[w,f]=l.useState(""),[S,C]=l.useState(!1),[v,x]=l.useState(!1),{editorOptions:k}=we(),{showMessage:y}=X();l.useEffect(()=>{a&&m()},[s.id,a]),l.useEffect(()=>{const j=c=>{const E=navigator.userAgent.includes("Mac");(E&&c.metaKey&&c.key==="s"||!E&&c.ctrlKey&&c.key==="s")&&(c.preventDefault(),N())};return window.addEventListener("keydown",j),()=>{window.removeEventListener("keydown",j)}},[h,t,w,g]);const m=async()=>{C(!0);const j=await d("/Challenge/GetChallengeCode","POST",{challengeId:s.id,language:a});j&&j.code&&(i(j.code),r(j.code.source)),C(!1)},N=async()=>{C(!0);const j=await d("/Challenge/SaveChallengeCode","POST",{challengeId:s.id,language:a,source:t});j&&j.data?(i(c=>({...c,...j.data})),r(j.data.source),y("Code saved successfully")):y("Code failed to save"),C(!1)},T=()=>{t!=(h==null?void 0:h.source)?x(!0):n()},P=()=>{x(!1),n()},o=async()=>{await N(),P()};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{style:{zIndex:"1060"},backdropClassName:"wb-challenges-editor__exit-modal__backdrop",show:v,onHide:()=>x(!1),centered:!0,children:[e.jsx(D.Header,{closeButton:!0,children:e.jsx(D.Title,{children:"Unsaved Changes"})}),e.jsx(D.Body,{children:"You have unsaved changes. Do you want to save before exiting?"}),e.jsxs(D.Footer,{children:[e.jsx(p,{variant:"secondary",onClick:P,children:"Exit Without Saving"}),e.jsx(p,{variant:"primary",onClick:o,children:"Save and Exit"})]})]}),e.jsx(D,{show:a!==null,onHide:T,fullscreen:!0,className:"p-0 m-0",contentClassName:"h-100",children:e.jsxs(D.Body,{className:"p-0 m-0 d-flex flex-column",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between border-bottom bg-white p-1",style:{height:"44px"},children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(p,{variant:"link",className:"text-secondary",onClick:T,children:e.jsx(ce,{})}),e.jsx("h5",{className:"mb-0",children:s.title})]}),e.jsx("div",{children:e.jsxs(O,{children:[e.jsx(O.Toggle,{as:oe}),e.jsx(O.Menu,{style:{width:"200px"},children:e.jsx(O.Item,{onClick:N,children:"Save"})})]})})]}),e.jsx("div",{className:"d-flex flex-column flex-grow-1 overflow-hidden",children:h!=null?e.jsx(Se,{code:h,source:t,setSource:r,css:w,setCss:f,js:g,setJs:b,options:k,tabHeightStyle:"calc(100dvh - 85px)",challenge:s,submission:h.lastSubmission}):S?e.jsx("div",{className:"d-flex w-100 h-100 justify-content-center align-items-center",children:e.jsx(B,{})}):e.jsx("p",{children:"Something went wrong"})})]})})]})},De=()=>{const{challengeId:s}=K(),a=q(),{userInfo:n}=$(),{sendJsonRequest:d}=R(),[h,i]=l.useState(!1),[t,r]=l.useState(null),[g,b]=l.useState(""),[w,f]=l.useState(null);l.useEffect(()=>{S()},[s]);const S=async()=>{if(!s)return;i(!0);const x=await d("/Challenge/GetChallenge","POST",{challengeId:s});x&&x.challenge&&r(x.challenge),i(!1)},C=()=>{f(null)},v=x=>{f(x)};return t!=null?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{challenge:t,language:w,onExit:C}),e.jsxs(U,{children:[e.jsxs("div",{className:"d-flex gap-2 py-2",children:[e.jsx(A,{to:"/Challenge",children:"Challenges"}),e.jsx("span",{children:"›"}),e.jsx("span",{children:ye(t.title,25)})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:t.title}),e.jsx("span",{className:`badge ${t.difficulty==="easy"?"bg-success":t.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:t.difficulty})]}),(n==null?void 0:n.roles.some(x=>["Admin","Creator"].includes(x)))&&e.jsx(de,{role:"button",title:"Edit Challenge",onClick:()=>a(`/Challenge/Edit/${t.id}`),className:"text-muted",style:{cursor:"pointer"}})]}),e.jsx(be,{content:t.description}),e.jsx("div",{className:"mt-2",children:e.jsx(Z,{challenge:t})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(he,{className:"fw-semibold",children:"Select language for solution:"}),e.jsxs(ue,{className:"mb-2",size:"sm",style:{maxWidth:"400px"},children:[e.jsxs(me,{value:g,onChange:x=>b(x.target.value),children:[e.jsx("option",{value:"",children:"-- Select Language --"}),Object.entries(W).filter(([x])=>x!="web").map(([x,k])=>e.jsx("option",{value:x,children:k.displayName},x))]}),e.jsx(p,{variant:"primary",disabled:!g,onClick:()=>v(g),children:"Open Editor"})]})]})]})]}):h?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(B,{})}):e.jsxs("div",{className:"d-flex h-100 py-5 flex-column align-items-center justify-content-center text-center",children:[e.jsx("h4",{children:e.jsx(xe,{})}),e.jsx("h5",{children:"Challenge not found"}),e.jsx("div",{children:e.jsx(A,{to:"/Challenge",children:"Go back"})})]})},Oe=({testCases:s,setTestCases:a})=>{const n=(i,t,r)=>{const g=[...s];g[i][t]=r,a(g)},d=()=>{a([...s,{input:"",expectedOutput:"",isHidden:!0}])},h=i=>{a(s.filter((t,r)=>r!==i))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Test Cases"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:s.map((i,t)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs("div",{className:"fw-semibold",children:["Test case #",t]}),e.jsxs(u.Group,{children:[e.jsx(u.Label,{htmlFor:"input"+t,children:"Input"}),e.jsx(u.Control,{id:"input"+t,as:"textarea",rows:3,value:i.input,placeholder:"Input",onChange:r=>n(t,"input",r.target.value)})]}),e.jsxs(u.Group,{children:[e.jsx(u.Label,{htmlFor:"expected-output"+t,children:"Expected Output"}),e.jsx(u.Control,{id:"expected-output"+t,as:"textarea",rows:3,value:i.expectedOutput,placeholder:"Expected output",onChange:r=>n(t,"expectedOutput",r.target.value)})]}),e.jsx(u.Check,{type:"checkbox",label:"Hidden?",checked:i.isHidden,onChange:r=>n(t,"isHidden",r.target.checked)}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>h(t),children:[e.jsx(Q,{})," Delete"]})})]},t))}),e.jsxs(p,{variant:"success",onClick:d,className:"m-2",children:[e.jsx(z,{className:"me-2"}),"Add TestCases"]})]})},He=({languages:s,setLanguages:a})=>{const n=(i,t,r)=>{const g=[...s];g[i][t]=r,a(g)},d=()=>{a([...s,{name:"",source:""}])},h=i=>{a(s.filter((t,r)=>r!==i))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Templates"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:s.map((i,t)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs(u.Group,{children:[e.jsx(u.Label,{children:"Language"}),e.jsx(u.Control,{type:"text",value:i.name,placeholder:"name",onChange:r=>n(t,"name",r.target.value)})]}),e.jsxs(u.Group,{children:[e.jsx(u.Label,{children:"Source"}),e.jsx(u.Control,{as:"textarea",rows:10,value:i.source,placeholder:"source",onChange:r=>n(t,"source",r.target.value)})]}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>h(t),children:[e.jsx(Q,{})," Delete"]})})]},t))}),e.jsx("div",{className:"mt-2",children:e.jsxs(p,{variant:"success",onClick:d,children:[e.jsx(z,{className:"me-2"}),"Add Template"]})})]})},ee=({challengeId:s})=>{const{sendJsonRequest:a}=R(),n=q(),[d,h]=l.useState(""),[i,t]=l.useState("easy"),[r,g]=l.useState(""),[b,w]=l.useState([]),[f,S]=l.useState([]),[C,v]=l.useState(""),{showMessage:x}=X(),[k,y]=l.useState(!1);l.useEffect(()=>{s&&m()},[s]);const m=async()=>{y(!0);const o=await a("/Challenge/GetUpdatedChallenge","POST",{challengeId:s});o&&o.challenge&&(h(o.challenge.title),g(o.challenge.description),t(o.challenge.difficulty),w(o.challenge.testCases),S(o.challenge.templates)),y(!1)},N=async()=>{const o=await a("/Challenge/Create","POST",{title:d,description:r,difficulty:i,testCases:b,templates:f});o&&o.challenge?(x("Challenge created Successfully"),n("/Challenge/"+o.challenge.id)):v((o==null?void 0:o.error[0].message)??"Something went wrong")},T=async()=>{const o=await a("/Challenge/Update","POST",{challengeId:s,title:d,description:r,difficulty:i,testCases:b,templates:f});o&&o.data?(x("Challenge updated Successfully"),n("/Challenge/"+o.data.id)):v((o==null?void 0:o.error[0].message)??"Something went wrong")},P=async o=>{o.preventDefault(),v(""),y(!0),s?await T():await N(),y(!1)};return e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx(z,{className:"me-2"})," ",s?"Update":"Create"," Challenge"]}),e.jsxs(u,{onSubmit:P,children:[e.jsxs(u.Group,{className:"mb-3",children:[e.jsx(u.Label,{children:"Title"}),e.jsx(u.Control,{type:"text",placeholder:"Enter challenge title",value:d,onChange:o=>h(o.target.value),required:!0})]}),e.jsxs(u.Group,{className:"mb-3",children:[e.jsxs(u.Label,{children:[e.jsx(ge,{className:"me-2"})," Description"]}),e.jsx(Ne,{text:r,setText:g,placeHolder:"Describe the challenge...",row:10,isPost:!1})]}),e.jsx(Oe,{testCases:b,setTestCases:w}),e.jsx(He,{languages:f,setLanguages:S}),e.jsxs(u.Group,{className:"mb-3",children:[e.jsxs(u.Label,{children:[e.jsx(je,{className:"me-2"})," Difficulty"]}),e.jsxs(u.Select,{value:i,onChange:o=>t(o.target.value),children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsx("p",{className:"col text-danger",children:C}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(J.LinkContainer,{to:s?"/Challenge/"+s:"/Challenge",children:e.jsx(p,{type:"button",variant:"secondary",disabled:k,children:"Cancel"})}),e.jsx(p,{type:"submit",variant:"primary",disabled:k,children:s?"Update":"Create"})]})]})]})},Re=()=>(G("Create Challenge"),e.jsx(ee,{})),Ge=()=>{G("Update Challenge");const{challengeId:s}=K();return e.jsx(ee,{challengeId:s})};const Ze=()=>e.jsx(pe,{children:e.jsxs(F,{element:e.jsx(Te,{Header:e.jsx(fe,{variant:"light"}),Footer:null}),children:[e.jsx(F,{index:!0,element:e.jsx(Pe,{})}),e.jsx(F,{element:e.jsx(M,{allowedRoles:ve}),children:e.jsx(F,{path:":challengeId",element:e.jsx(De,{})})}),e.jsxs(F,{element:e.jsx(M,{allowedRoles:["Admin","Creator"]}),children:[e.jsx(F,{path:"Create",element:e.jsx(Re,{})}),e.jsx(F,{path:"Edit/:challengeId",element:e.jsx(Ge,{})})]})]})});export{Ze as default};
