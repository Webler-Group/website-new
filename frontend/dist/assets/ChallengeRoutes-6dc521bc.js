import{r as a,u as ne,j as e,c as re,B as p,C as K,R as Q,a as R,O as ie,b as T,P as B,d as q,e as W,f as G,g as ce,F as d,h as oe,i as Y,L as M,k as de,l as V,m as he,D as H,E as ue,n as X,o as $,p as me,q as xe,s as Z,t as z,v as ge,w as je,x as pe,y as F,H as fe,z as I}from"./index-38762e4d.js";import{T as J}from"./Toast-c52d7496.js";import{P as Ce}from"./react-bootstrap-pagination-control.esm-e95cb606.js";import{l as ee}from"./Code-04da1ecb.js";import{r as ve}from"./roles-68ed67e6.js";import{t as ye}from"./StringUtils-91be14c5.js";import{M as be}from"./PostTextareaControl-c864b56a.js";import{u as we,C as Ne}from"./useEditorOptions-7b7c5c36.js";import{M as D}from"./Modal-a3a3dd82.js";import{M as Se}from"./MdEditorField-37dfeb5f.js";import"./PostAttachmentSelect-629920e8.js";import"./CodeList-dc94e790.js";import"./Spinner-e45287bd.js";import"./Tabs-2d218bb2.js";import"./Tab-d4df9ed6.js";const ke={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},se=a.forwardRef(({bsPrefix:t,position:n,containerPosition:c,className:h,as:m="div",...r},s)=>(t=ne(t,"toast-container"),e.jsx(m,{ref:s,...r,className:re(t,n&&ke[n],c&&`position-${c}`,h)})));se.displayName="ToastContainer";const Ee=se,te=a.createContext(void 0),ae=()=>{const t=a.useContext(te);if(!t)throw new Error("useSnackbar must be used within SnackbarProvider");return t},Te=({children:t})=>{const[n,c]=a.useState(null),h=m=>{c(m),setTimeout(()=>c(null),3e3)};return e.jsxs(te.Provider,{value:{showMessage:h},children:[t,e.jsx(Ee,{position:"bottom-end",className:"p-3",children:e.jsx(J,{bg:"dark",show:!!n,onClose:()=>c(null),delay:3e3,autohide:!0,children:e.jsx(J.Body,{className:"text-white",children:n})})})]})},Le=({Header:t,Footer:n,SideMenu:c,AsideMenu:h})=>{const[m,r]=a.useState(!1),[s,l]=a.useState(!1);return e.jsx(Te,{children:e.jsxs("div",{className:"d-flex flex-column min-vh-100",children:[t&&e.jsxs("header",{className:"sticky-top bg-light shadow-sm d-flex align-items-center justify-content-between p-2 bg-warning",children:[t,e.jsxs("div",{className:"d-md-none d-flex gap-2",children:[c&&e.jsx(p,{size:"sm",variant:"outline-primary",onClick:()=>r(!0),children:"Menu"}),h&&e.jsx(p,{size:"sm",variant:"outline-secondary",onClick:()=>l(!0),children:"Info"})]})]}),e.jsx(K,{className:"py-2",children:e.jsxs(Q,{children:[c&&e.jsx(R,{xs:12,md:2,className:"bg-light border-end d-none d-md-block",children:c}),e.jsx(R,{xs:12,md:h?8:10,children:e.jsx(ie,{})}),h&&e.jsx(R,{xs:12,md:2,className:"bg-white border-start d-none d-md-block",children:h})]})}),n&&e.jsx("footer",{className:"bg-dark text-white p-3 mt-auto",children:n}),c&&e.jsxs(T,{show:m,onHide:()=>r(!1),responsive:"md",children:[e.jsx(T.Header,{closeButton:!0,children:e.jsx(T.Title,{children:"Menu"})}),e.jsx(T.Body,{children:c})]}),h&&e.jsxs(T,{show:s,onHide:()=>l(!1),responsive:"md",placement:"end",children:[e.jsx(T.Header,{closeButton:!0,children:e.jsx(T.Title,{children:"Info"})}),e.jsx(T.Body,{children:h})]})]})})},Pe=()=>{B("Code Challenge");const{sendJsonRequest:t}=q(),{userInfo:n}=W(),c=G(),[h,m]=a.useState([]),r=10,[s,l]=a.useState(1),[g,v]=a.useState(0),[w,y]=a.useState(!1),[N,x]=a.useState("all"),[f,C]=a.useState(""),[S,b]=a.useState(""),[u,k]=ce();a.useEffect(()=>{o()},[u]),a.useEffect(()=>{L(1)},[N,status,S]),a.useEffect(()=>{u.has("page")&&l(Number(u.get("page"))),u.has("difficulty")&&x(u.get("difficulty")),u.has("query")&&(b(u.get("query")),C(u.get("query")))},[]);const L=i=>{s!==i&&(u.set("page",i.toString()),k(u,{replace:!0}),l(i))},P=()=>{u.set("query",f),k(u,{replace:!0}),b(f)},o=async()=>{y(!0);const i=await t("/Challenge","POST",{page:u.has("page")?Number(u.get("page")):1,count:r,difficulty:u.has("difficulty")?u.get("difficulty"):null,searchQuery:u.has("query")?u.get("query"):""});i&&i.challenges&&(m(i.challenges),v(i.count)),y(!1)},j=i=>{const E=i.target.selectedOptions[0].value;E=="all"?u.delete("difficulty"):u.set("difficulty",E),k(u,{replace:!0}),x(E)};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(d.Label,{htmlFor:"search",className:"visually-hidden",children:"Search challenges"}),e.jsx(oe,{id:"search",type:"search",size:"sm",placeholder:"Search...",value:f,onChange:i=>C(i.target.value),onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),P())}}),e.jsx(p,{size:"sm",onClick:P,children:"Search"})]}),e.jsxs("div",{className:"mt-2 d-sm-flex flex-row-reverse justify-content-between",children:[(n==null?void 0:n.roles.some(i=>["Admin","Creator"].includes(i)))&&e.jsx("div",{className:"mb-2 d-flex justify-content-end",children:e.jsx(Y.LinkContainer,{to:"/Challenge/Create",children:e.jsx(p,{size:"sm",children:"New challenge"})})}),e.jsx("div",{className:"d-flex gap-2 justify-content-between",children:e.jsxs(d.Group,{children:[e.jsx(d.Label,{htmlFor:"difficulty",className:"visually-hidden",children:"Difficulty"}),e.jsxs(d.Select,{id:"difficulty",style:{width:"120px"},size:"sm",value:N,onChange:j,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]})})]}),e.jsx("div",{className:"mt-2",children:w?e.jsx(M,{}):g===0?e.jsx("div",{className:"wb-empty-list",children:e.jsx("h3",{children:"Nothing to show"})}):e.jsx(Q,{className:"g-2",children:h.map((i,E)=>e.jsx(R,{xs:12,sm:6,lg:4,children:e.jsxs("div",{className:"shadow-sm border rounded p-2",onClick:()=>c(`/Challenge/${i.id}`),style:{cursor:"pointer"},children:[e.jsx("div",{className:"fw-semibold",children:i.title}),e.jsx("div",{children:e.jsx(de,{className:`${i.difficulty==="easy"?"bg-success":i.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:i.difficulty})}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-2",children:Object.entries(ee).filter(([O])=>O!="web").map(([O,A])=>{var U;return e.jsxs("div",{className:"d-flex justify-content-center align-items-center rounded-circle text-light position-relative small",style:{backgroundColor:A.color,width:"32px",height:"32px"},children:[A.shortName,((U=i.submissions)==null?void 0:U.some(_=>_.language===O&&_.passed))&&e.jsx("div",{className:"position-absolute bottom-0 end-0 text-success",children:e.jsx(V,{})})]},O)})})]})},E))})}),e.jsx("div",{className:"my-3",children:e.jsx(Ce,{page:s,between:3,total:g,limit:r,changePage:L,ellipsis:1})})]})},Fe=({challenge:t,language:n,onExit:c})=>{const{sendJsonRequest:h}=q(),[m,r]=a.useState(null),[s,l]=a.useState(""),[g,v]=a.useState(""),[w,y]=a.useState(""),[N,x]=a.useState(!1),[f,C]=a.useState(!1),{editorOptions:S}=we(),{showMessage:b}=ae();a.useEffect(()=>{n&&u()},[t.id,n]),a.useEffect(()=>{const j=i=>{const E=navigator.userAgent.includes("Mac");(E&&i.metaKey&&i.key==="s"||!E&&i.ctrlKey&&i.key==="s")&&(i.preventDefault(),k())};return window.addEventListener("keydown",j),()=>{window.removeEventListener("keydown",j)}},[m,s,w,g]);const u=async()=>{x(!0);const j=await h("/Challenge/GetChallengeCode","POST",{challengeId:t.id,language:n});j&&j.code&&(r(j.code),l(j.code.source)),x(!1)},k=async()=>{x(!0);const j=await h("/Challenge/SaveChallengeCode","POST",{challengeId:t.id,language:n,source:s});j&&j.data?(r(i=>({...i,...j.data})),l(j.data.source),b("Code saved successfully")):b("Code failed to save"),x(!1)},L=()=>{s!=(m==null?void 0:m.source)?C(!0):c()},P=()=>{C(!1),c()},o=async()=>{await k(),P()};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{style:{zIndex:"1060"},backdropClassName:"wb-challenges-editor__exit-modal__backdrop",show:f,onHide:()=>C(!1),centered:!0,children:[e.jsx(D.Header,{closeButton:!0,children:e.jsx(D.Title,{children:"Unsaved Changes"})}),e.jsx(D.Body,{children:"You have unsaved changes. Do you want to save before exiting?"}),e.jsxs(D.Footer,{children:[e.jsx(p,{variant:"secondary",onClick:P,children:"Exit Without Saving"}),e.jsx(p,{variant:"primary",onClick:o,children:"Save and Exit"})]})]}),e.jsx(D,{show:n!==null,onHide:L,fullscreen:!0,className:"p-0 m-0",contentClassName:"h-100",children:e.jsxs(D.Body,{className:"p-0 m-0 d-flex flex-column",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between border-bottom bg-white p-1",style:{height:"44px"},children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(p,{variant:"link",className:"text-secondary",onClick:L,children:e.jsx(he,{})}),e.jsx("h5",{className:"mb-0",children:t.title})]}),e.jsx("div",{children:e.jsxs(H,{children:[e.jsx(H.Toggle,{as:ue}),e.jsx(H.Menu,{style:{width:"200px"},children:e.jsx(H.Item,{onClick:k,children:"Save"})})]})})]}),e.jsx("div",{className:"d-flex flex-column flex-grow-1 overflow-hidden",children:m!=null?e.jsx(Ne,{code:m,source:s,setSource:l,css:w,setCss:y,js:g,setJs:v,options:S,tabHeightStyle:"calc(100dvh - 85px)",challenge:t,submission:m.lastSubmission}):N?e.jsx("div",{className:"d-flex w-100 h-100 justify-content-center align-items-center",children:e.jsx(M,{})}):e.jsx("p",{children:"Something went wrong"})})]})})]})},De=()=>{const{challengeId:t}=X(),n=G(),{userInfo:c}=W(),{sendJsonRequest:h}=q(),[m,r]=a.useState(!1),[s,l]=a.useState(null),[g,v]=a.useState(null);a.useEffect(()=>{w()},[t]);const w=async()=>{if(!t)return;r(!0);const x=await h("/Challenge/GetChallenge","POST",{challengeId:t});x&&x.challenge&&l(x.challenge),r(!1)},y=()=>{v(null)},N=x=>{v(x)};return s!=null?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{challenge:s,language:g,onExit:y}),e.jsxs(K,{children:[e.jsxs("div",{className:"d-flex gap-2 py-2",children:[e.jsx($,{to:"/Challenge",children:"Challenges"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{children:ye(s.title,25)})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:s.title}),e.jsx("span",{className:`badge ${s.difficulty==="easy"?"bg-success":s.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:s.difficulty})]}),(c==null?void 0:c.roles.some(x=>["Admin","Creator"].includes(x)))&&e.jsx(me,{role:"button",title:"Edit Challenge",onClick:()=>n(`/Challenge/Edit/${s.id}`),className:"text-muted",style:{cursor:"pointer"}})]}),e.jsx(be,{content:s.description}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-2",children:Object.entries(ee).filter(([x])=>x!="web").map(([x,f])=>{var C;return e.jsxs("div",{className:"d-flex justify-content-center align-items-center rounded-circle text-light position-relative small",style:{backgroundColor:f.color,width:"32px",height:"32px",cursor:"pointer"},onClick:()=>N(x),children:[f.shortName,((C=s.submissions)==null?void 0:C.some(S=>S.language===x&&S.passed))&&e.jsx("div",{className:"position-absolute bottom-0 end-0 text-success",children:e.jsx(V,{})})]},x)})})]})]}):m?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(M,{})}):e.jsxs("div",{className:"d-flex h-100 py-5 flex-column align-items-center justify-content-center text-center",children:[e.jsx("h4",{children:e.jsx(xe,{})}),e.jsx("h5",{children:"Challenge not found"}),e.jsx("div",{children:e.jsx($,{to:"/Challenge",children:"Go back"})})]})},Oe=({testCases:t,setTestCases:n})=>{const c=(r,s,l)=>{const g=[...t];g[r][s]=l,n(g)},h=()=>{n([...t,{input:"",expectedOutput:"",isHidden:!0}])},m=r=>{n(t.filter((s,l)=>l!==r))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Test Cases"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:t.map((r,s)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs("div",{className:"fw-semibold",children:["Test case #",s]}),e.jsxs(d.Group,{children:[e.jsx(d.Label,{htmlFor:"input"+s,children:"Input"}),e.jsx(d.Control,{id:"input"+s,as:"textarea",rows:3,value:r.input,placeholder:"Input",onChange:l=>c(s,"input",l.target.value)})]}),e.jsxs(d.Group,{children:[e.jsx(d.Label,{htmlFor:"expected-output"+s,children:"Expected Output"}),e.jsx(d.Control,{id:"expected-output"+s,as:"textarea",rows:3,value:r.expectedOutput,placeholder:"Expected output",onChange:l=>c(s,"expectedOutput",l.target.value)})]}),e.jsx(d.Check,{type:"checkbox",label:"Hidden?",checked:r.isHidden,onChange:l=>c(s,"isHidden",l.target.checked)}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>m(s),children:[e.jsx(Z,{})," Delete"]})})]},s))}),e.jsxs(p,{variant:"success",onClick:h,className:"m-2",children:[e.jsx(z,{className:"me-2"}),"Add TestCases"]})]})},He=({languages:t,setLanguages:n})=>{const c=(r,s,l)=>{const g=[...t];g[r][s]=l,n(g)},h=()=>{n([...t,{name:"",source:""}])},m=r=>{n(t.filter((s,l)=>l!==r))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Templates"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:t.map((r,s)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs(d.Group,{children:[e.jsx(d.Label,{children:"Language"}),e.jsx(d.Control,{type:"text",value:r.name,placeholder:"name",onChange:l=>c(s,"name",l.target.value)})]}),e.jsxs(d.Group,{children:[e.jsx(d.Label,{children:"Source"}),e.jsx(d.Control,{as:"textarea",rows:10,value:r.source,placeholder:"source",onChange:l=>c(s,"source",l.target.value)})]}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>m(s),children:[e.jsx(Z,{})," Delete"]})})]},s))}),e.jsx("div",{className:"mt-2",children:e.jsxs(p,{variant:"success",onClick:h,children:[e.jsx(z,{className:"me-2"}),"Add Template"]})})]})},le=({challengeId:t})=>{const{sendJsonRequest:n}=q(),c=G(),[h,m]=a.useState(""),[r,s]=a.useState("easy"),[l,g]=a.useState(""),[v,w]=a.useState([]),[y,N]=a.useState([]),[x,f]=a.useState(""),{showMessage:C}=ae(),[S,b]=a.useState(!1);a.useEffect(()=>{t&&u()},[t]);const u=async()=>{b(!0);const o=await n("/Challenge/GetUpdatedChallenge","POST",{challengeId:t});o&&o.challenge&&(m(o.challenge.title),g(o.challenge.description),s(o.challenge.difficulty),w(o.challenge.testCases),N(o.challenge.templates)),b(!1)},k=async()=>{const o=await n("/Challenge/Create","POST",{title:h,description:l,difficulty:r,testCases:v,templates:y});o&&o.challenge?(C("Challenge created Successfully"),c("/Challenge/"+o.challenge.id)):f((o==null?void 0:o.error[0].message)??"Something went wrong")},L=async()=>{const o=await n("/Challenge/Update","POST",{challengeId:t,title:h,description:l,difficulty:r,testCases:v,templates:y});o&&o.data?(C("Challenge updated Successfully"),c("/Challenge/"+o.data.id)):f((o==null?void 0:o.error[0].message)??"Something went wrong")},P=async o=>{o.preventDefault(),f(""),b(!0),t?await L():await k(),b(!1)};return e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx(z,{className:"me-2"})," ",t?"Update":"Create"," Challenge"]}),e.jsxs(d,{onSubmit:P,children:[e.jsxs(d.Group,{className:"mb-3",children:[e.jsx(d.Label,{children:"Title"}),e.jsx(d.Control,{type:"text",placeholder:"Enter challenge title",value:h,onChange:o=>m(o.target.value),required:!0})]}),e.jsxs(d.Group,{className:"mb-3",children:[e.jsxs(d.Label,{children:[e.jsx(ge,{className:"me-2"})," Description"]}),e.jsx(Se,{text:l,setText:g,placeHolder:"Describe the challenge...",row:10,isPost:!1})]}),e.jsx(Oe,{testCases:v,setTestCases:w}),e.jsx(He,{languages:y,setLanguages:N}),e.jsxs(d.Group,{className:"mb-3",children:[e.jsxs(d.Label,{children:[e.jsx(je,{className:"me-2"})," Difficulty"]}),e.jsxs(d.Select,{value:r,onChange:o=>s(o.target.value),children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsx("p",{className:"col text-danger",children:x}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(Y.LinkContainer,{to:t?"/Challenge/"+t:"/Challenge",children:e.jsx(p,{type:"button",variant:"secondary",disabled:S,children:"Cancel"})}),e.jsx(p,{type:"submit",variant:"primary",disabled:S,children:t?"Update":"Create"})]})]})]})},Re=()=>(B("Create Challenge"),e.jsx(le,{})),qe=()=>{B("Update Challenge");const{challengeId:t}=X();return e.jsx(le,{challengeId:t})};const Xe=()=>e.jsx(pe,{children:e.jsxs(F,{element:e.jsx(Le,{Header:e.jsx(fe,{variant:"light"}),Footer:null}),children:[e.jsx(F,{index:!0,element:e.jsx(Pe,{})}),e.jsx(F,{element:e.jsx(I,{allowedRoles:ve}),children:e.jsx(F,{path:":challengeId",element:e.jsx(De,{})})}),e.jsxs(F,{element:e.jsx(I,{allowedRoles:["Admin","Creator"]}),children:[e.jsx(F,{path:"Create",element:e.jsx(Re,{})}),e.jsx(F,{path:"Edit/:challengeId",element:e.jsx(qe,{})})]})]})});export{Xe as default};
