import{r as a,u as ae,j as e,c as le,B as p,C as J,R as K,a as H,O as ne,b as k,P as B,d as R,e as G,f as re,F as h,g as ie,h as Q,L as M,i as ce,k as W,l as oe,D as O,E as de,m as Y,n as he,o as I,p as ue,q as xe,s as V,t as z,v as me,w as ge,x as je,y as P,H as pe,z as _}from"./index-11d2e42e.js";import{T as $}from"./Toast-0c9237c7.js";import{P as fe}from"./react-bootstrap-pagination-control.esm-f5e252ef.js";import{l as X}from"./Code-4f0eb453.js";import{r as Ce}from"./roles-68ed67e6.js";import{t as ve}from"./StringUtils-91be14c5.js";import{M as ye}from"./PostTextareaControl-aba28153.js";import{u as be,C as we}from"./useEditorOptions-299d2e23.js";import{M as F}from"./Modal-772d06a5.js";import{M as Ne}from"./MdEditorField-10097716.js";import"./PostAttachmentSelect-89cfd0db.js";import"./CodeList-3ead88bb.js";import"./Spinner-37b9e594.js";import"./Tabs-38defef1.js";import"./Tab-33305906.js";const Se={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},Z=a.forwardRef(({bsPrefix:t,position:o,containerPosition:i,className:u,as:x="div",...r},s)=>(t=ae(t,"toast-container"),e.jsx(x,{ref:s,...r,className:le(t,o&&Se[o],i&&`position-${i}`,u)})));Z.displayName="ToastContainer";const ke=Z,ee=a.createContext(void 0),se=()=>{const t=a.useContext(ee);if(!t)throw new Error("useSnackbar must be used within SnackbarProvider");return t},Ee=({children:t})=>{const[o,i]=a.useState(null),u=x=>{i(x),setTimeout(()=>i(null),3e3)};return e.jsxs(ee.Provider,{value:{showMessage:u},children:[t,e.jsx(ke,{position:"bottom-end",className:"p-3",children:e.jsx($,{bg:"dark",show:!!o,onClose:()=>i(null),delay:3e3,autohide:!0,children:e.jsx($.Body,{className:"text-white",children:o})})})]})},Te=({Header:t,Footer:o,SideMenu:i,AsideMenu:u})=>{const[x,r]=a.useState(!1),[s,n]=a.useState(!1);return e.jsx(Ee,{children:e.jsxs("div",{className:"d-flex flex-column min-vh-100",children:[t&&e.jsxs("header",{className:"sticky-top bg-light shadow-sm d-flex align-items-center justify-content-between p-2 bg-warning",children:[t,e.jsxs("div",{className:"d-md-none d-flex gap-2",children:[i&&e.jsx(p,{size:"sm",variant:"outline-primary",onClick:()=>r(!0),children:"Menu"}),u&&e.jsx(p,{size:"sm",variant:"outline-secondary",onClick:()=>n(!0),children:"Info"})]})]}),e.jsx(J,{className:"py-2",children:e.jsxs(K,{children:[i&&e.jsx(H,{xs:12,md:2,className:"bg-light border-end d-none d-md-block",children:i}),e.jsx(H,{xs:12,md:u?8:10,children:e.jsx(ne,{})}),u&&e.jsx(H,{xs:12,md:2,className:"bg-white border-start d-none d-md-block",children:u})]})}),o&&e.jsx("footer",{className:"bg-dark text-white p-3 mt-auto",children:o}),i&&e.jsxs(k,{show:x,onHide:()=>r(!1),responsive:"md",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Menu"})}),e.jsx(k.Body,{children:i})]}),u&&e.jsxs(k,{show:s,onHide:()=>n(!1),responsive:"md",placement:"end",children:[e.jsx(k.Header,{closeButton:!0,children:e.jsx(k.Title,{children:"Info"})}),e.jsx(k.Body,{children:u})]})]})})},Le=()=>{B("Code Challenge");const{sendJsonRequest:t}=R(),o=G(),[i,u]=a.useState([]),x=10,[r,s]=a.useState(1),[n,g]=a.useState(0),[v,y]=a.useState(!1),[b,N]=a.useState("all"),[m,f]=a.useState(""),[C,w]=a.useState(""),[d,E]=re();a.useEffect(()=>{D()},[d]),a.useEffect(()=>{S(1)},[b,status,C]),a.useEffect(()=>{d.has("page")&&s(Number(d.get("page"))),d.has("difficulty")&&N(d.get("difficulty")),d.has("query")&&(w(d.get("query")),f(d.get("query")))},[]);const S=l=>{r!==l&&(d.set("page",l.toString()),E(d,{replace:!0}),s(l))},T=()=>{d.set("query",m),E(d,{replace:!0}),w(m)},D=async()=>{y(!0);const l=await t("/Challenge","POST",{page:d.has("page")?Number(d.get("page")):1,count:x,difficulty:d.has("difficulty")?d.get("difficulty"):null,searchQuery:d.has("query")?d.get("query"):""});l&&l.challenges&&(u(l.challenges),g(l.count)),y(!1)},c=l=>{const j=l.target.selectedOptions[0].value;j=="all"?d.delete("difficulty"):d.set("difficulty",j),E(d,{replace:!0}),N(j)};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(h.Label,{htmlFor:"search",className:"visually-hidden",children:"Search challenges"}),e.jsx(ie,{id:"search",type:"search",size:"sm",placeholder:"Search...",value:m,onChange:l=>f(l.target.value),onKeyDown:l=>{l.key==="Enter"&&(l.preventDefault(),T())}}),e.jsx(p,{size:"sm",onClick:T,children:"Search"})]}),e.jsxs("div",{className:"mt-2 d-sm-flex flex-row-reverse justify-content-between",children:[e.jsx("div",{className:"mb-2 d-flex justify-content-end",children:e.jsx(Q.LinkContainer,{to:"/Challenge/Create",children:e.jsx(p,{size:"sm",children:"New challenge"})})}),e.jsx("div",{className:"d-flex gap-2 justify-content-between",children:e.jsxs(h.Group,{children:[e.jsx(h.Label,{htmlFor:"difficulty",className:"visually-hidden",children:"Difficulty"}),e.jsxs(h.Select,{id:"difficulty",style:{width:"120px"},size:"sm",value:b,onChange:c,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]})})]}),e.jsx("div",{className:"mt-2",children:v?e.jsx(M,{}):n===0?e.jsx("div",{className:"wb-empty-list",children:e.jsx("h3",{children:"Nothing to show"})}):e.jsx(K,{className:"g-2",children:i.map((l,j)=>e.jsx(H,{xs:12,sm:6,lg:4,children:e.jsxs("div",{className:"shadow-sm border rounded p-2",onClick:()=>o(`/Challenge/${l.id}`),style:{cursor:"pointer"},children:[e.jsx("div",{className:"fw-semibold",children:l.title}),e.jsx("div",{children:e.jsx(ce,{className:`${l.difficulty==="easy"?"bg-success":l.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:l.difficulty})}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-2",children:Object.entries(X).filter(([L])=>L!="web").map(([L,q])=>{var A;return e.jsxs("div",{className:"d-flex justify-content-center align-items-center rounded-circle text-light position-relative small",style:{backgroundColor:q.color,width:"32px",height:"32px"},children:[q.shortName,((A=l.submissions)==null?void 0:A.some(U=>U.language===L&&U.passed))&&e.jsx("div",{className:"position-absolute bottom-0 end-0 text-success",children:e.jsx(W,{})})]},L)})})]})},j))})}),e.jsx("div",{className:"my-3",children:e.jsx(fe,{page:r,between:3,total:n,limit:x,changePage:S,ellipsis:1})})]})},Pe=({challenge:t,language:o,onExit:i})=>{const{sendJsonRequest:u}=R(),[x,r]=a.useState(null),[s,n]=a.useState(""),[g,v]=a.useState(""),[y,b]=a.useState(""),[N,m]=a.useState(!1),[f,C]=a.useState(!1),{editorOptions:w}=be(),{showMessage:d}=se();a.useEffect(()=>{o&&E()},[t.id,o]),a.useEffect(()=>{const l=j=>{const L=navigator.userAgent.includes("Mac");(L&&j.metaKey&&j.key==="s"||!L&&j.ctrlKey&&j.key==="s")&&(j.preventDefault(),S())};return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}},[x,s,y,g]);const E=async()=>{m(!0);const l=await u("/Challenge/GetChallengeCode","POST",{challengeId:t.id,language:o});l&&l.code&&(r(l.code),n(l.code.source)),m(!1)},S=async()=>{m(!0);const l=await u("/Challenge/SaveChallengeCode","POST",{challengeId:t.id,language:o,source:s});l&&l.data?(r(j=>({...j,...l.data})),n(l.data.source),d("Code saved successfully")):d("Code failed to save"),m(!1)},T=()=>{s!=(x==null?void 0:x.source)?C(!0):i()},D=()=>{C(!1),i()},c=async()=>{await S(),D()};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{style:{zIndex:"1060"},backdropClassName:"wb-challenges-editor__exit-modal__backdrop",show:f,onHide:()=>C(!1),centered:!0,children:[e.jsx(F.Header,{closeButton:!0,children:e.jsx(F.Title,{children:"Unsaved Changes"})}),e.jsx(F.Body,{children:"You have unsaved changes. Do you want to save before exiting?"}),e.jsxs(F.Footer,{children:[e.jsx(p,{variant:"secondary",onClick:D,children:"Exit Without Saving"}),e.jsx(p,{variant:"primary",onClick:c,children:"Save and Exit"})]})]}),e.jsx(F,{show:o!==null,onHide:T,fullscreen:!0,className:"p-0 m-0",contentClassName:"h-100",children:e.jsxs(F.Body,{className:"p-0 m-0 d-flex flex-column",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between border-bottom bg-white p-1",style:{height:"44px"},children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(p,{variant:"link",className:"text-secondary",onClick:T,children:e.jsx(oe,{})}),e.jsx("h5",{className:"mb-0",children:t.title})]}),e.jsx("div",{children:e.jsxs(O,{children:[e.jsx(O.Toggle,{as:de}),e.jsx(O.Menu,{style:{width:"200px"},children:e.jsx(O.Item,{onClick:S,children:"Save"})})]})})]}),e.jsx("div",{className:"d-flex flex-column flex-grow-1 overflow-hidden",children:x!=null?e.jsx(we,{code:x,source:s,setSource:n,css:y,setCss:b,js:g,setJs:v,options:w,tabHeightStyle:"calc(100dvh - 85px)",challenge:t,submission:x.lastSubmission}):N?e.jsx("div",{className:"d-flex w-100 h-100 justify-content-center align-items-center",children:e.jsx(M,{})}):e.jsx("p",{children:"Something went wrong"})})]})})]})},Fe=()=>{const{challengeId:t}=Y(),o=G(),{userInfo:i}=he(),{sendJsonRequest:u}=R(),[x,r]=a.useState(!1),[s,n]=a.useState(null),[g,v]=a.useState(null);a.useEffect(()=>{y()},[t]);const y=async()=>{if(!t)return;r(!0);const m=await u("/Challenge/GetChallenge","POST",{challengeId:t});m&&m.challenge&&n(m.challenge),r(!1)},b=()=>{v(null)},N=m=>{v(m)};return s!=null?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{challenge:s,language:g,onExit:b}),e.jsxs(J,{children:[e.jsxs("div",{className:"d-flex gap-2 py-2",children:[e.jsx(I,{to:"/Challenge",children:"Challenges"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{children:ve(s.title,25)})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:s.title}),e.jsx("span",{className:`badge ${s.difficulty==="easy"?"bg-success":s.difficulty==="medium"?"bg-warning text-dark":"bg-danger"}`,children:s.difficulty})]}),(i==null?void 0:i.roles.some(m=>["Admin","Creator"].includes(m)))&&e.jsx(ue,{role:"button",title:"Edit Challenge",onClick:()=>o(`/Challenge/Edit/${s.id}`),className:"text-muted",style:{cursor:"pointer"}})]}),e.jsx(ye,{content:s.description}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-2",children:Object.entries(X).filter(([m])=>m!="web").map(([m,f])=>{var C;return e.jsxs("div",{className:"d-flex justify-content-center align-items-center rounded-circle text-light position-relative small",style:{backgroundColor:f.color,width:"32px",height:"32px",cursor:"pointer"},onClick:()=>N(m),children:[f.shortName,((C=s.submissions)==null?void 0:C.some(w=>w.language===m&&w.passed))&&e.jsx("div",{className:"position-absolute bottom-0 end-0 text-success",children:e.jsx(W,{})})]},m)})})]})]}):x?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(M,{})}):e.jsxs("div",{className:"d-flex h-100 py-5 flex-column align-items-center justify-content-center text-center",children:[e.jsx("h4",{children:e.jsx(xe,{})}),e.jsx("h5",{children:"Challenge not found"}),e.jsx("div",{children:e.jsx(I,{to:"/Challenge",children:"Go back"})})]})},De=({testCases:t,setTestCases:o})=>{const i=(r,s,n)=>{const g=[...t];g[r][s]=n,o(g)},u=()=>{o([...t,{input:"",expectedOutput:"",isHidden:!0}])},x=r=>{o(t.filter((s,n)=>n!==r))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Test Cases"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:t.map((r,s)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs("div",{className:"fw-semibold",children:["Test case #",s]}),e.jsxs(h.Group,{children:[e.jsx(h.Label,{htmlFor:"input"+s,children:"Input"}),e.jsx(h.Control,{id:"input"+s,as:"textarea",rows:3,value:r.input,placeholder:"Input",onChange:n=>i(s,"input",n.target.value)})]}),e.jsxs(h.Group,{children:[e.jsx(h.Label,{htmlFor:"expected-output"+s,children:"Expected Output"}),e.jsx(h.Control,{id:"expected-output"+s,as:"textarea",rows:3,value:r.expectedOutput,placeholder:"Expected output",onChange:n=>i(s,"expectedOutput",n.target.value)})]}),e.jsx(h.Check,{type:"checkbox",label:"Hidden?",checked:r.isHidden,onChange:n=>i(s,"isHidden",n.target.checked)}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>x(s),children:[e.jsx(V,{})," Delete"]})})]},s))}),e.jsxs(p,{variant:"success",onClick:u,className:"m-2",children:[e.jsx(z,{className:"me-2"}),"Add TestCases"]})]})},Oe=({languages:t,setLanguages:o})=>{const i=(r,s,n)=>{const g=[...t];g[r][s]=n,o(g)},u=()=>{o([...t,{name:"",source:""}])},x=r=>{o(t.filter((s,n)=>n!==r))};return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:"Templates"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:t.map((r,s)=>e.jsxs("div",{className:"border rounded p-2 d-flex flex-column gap-2 shadow-sm",children:[e.jsxs(h.Group,{children:[e.jsx(h.Label,{children:"Language"}),e.jsx(h.Control,{type:"text",value:r.name,placeholder:"name",onChange:n=>i(s,"name",n.target.value)})]}),e.jsxs(h.Group,{children:[e.jsx(h.Label,{children:"Source"}),e.jsx(h.Control,{as:"textarea",rows:10,value:r.source,placeholder:"source",onChange:n=>i(s,"source",n.target.value)})]}),e.jsx("div",{children:e.jsxs(p,{variant:"danger",size:"sm",onClick:()=>x(s),children:[e.jsx(V,{})," Delete"]})})]},s))}),e.jsx("div",{className:"mt-2",children:e.jsxs(p,{variant:"success",onClick:u,children:[e.jsx(z,{className:"me-2"}),"Add Template"]})})]})},te=({challengeId:t})=>{const{sendJsonRequest:o}=R(),i=G(),[u,x]=a.useState(""),[r,s]=a.useState("easy"),[n,g]=a.useState(""),[v,y]=a.useState([]),[b,N]=a.useState([]),[m,f]=a.useState(""),{showMessage:C}=se(),[w,d]=a.useState(!1);a.useEffect(()=>{t&&E()},[t]);const E=async()=>{d(!0);const c=await o("/Challenge/GetUpdatedChallenge","POST",{challengeId:t});c&&c.challenge&&(x(c.challenge.title),g(c.challenge.description),s(c.challenge.difficulty),y(c.challenge.testCases),N(c.challenge.templates)),d(!1)},S=async()=>{const c=await o("/Challenge/Create","POST",{title:u,description:n,difficulty:r,testCases:v,templates:b});c&&c.challenge?(C("Challenge created Successfully"),i("/Challenge/"+c.challenge.id)):f((c==null?void 0:c.error[0].message)??"Something went wrong")},T=async()=>{const c=await o("/Challenge/Update","POST",{challengeId:t,title:u,description:n,difficulty:r,testCases:v,templates:b});c&&c.data?(C("Challenge updated Successfully"),i("/Challenge/"+c.data.id)):f((c==null?void 0:c.error[0].message)??"Something went wrong")},D=async c=>{c.preventDefault(),f(""),d(!0),t?await T():await S(),d(!1)};return e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx(z,{className:"me-2"})," ",t?"Update":"Create"," Challenge"]}),e.jsxs(h,{onSubmit:D,children:[e.jsxs(h.Group,{className:"mb-3",children:[e.jsx(h.Label,{children:"Title"}),e.jsx(h.Control,{type:"text",placeholder:"Enter challenge title",value:u,onChange:c=>x(c.target.value),required:!0})]}),e.jsxs(h.Group,{className:"mb-3",children:[e.jsxs(h.Label,{children:[e.jsx(me,{className:"me-2"})," Description"]}),e.jsx(Ne,{text:n,setText:g,placeHolder:"Describe the challenge...",row:10,isPost:!1})]}),e.jsx(De,{testCases:v,setTestCases:y}),e.jsx(Oe,{languages:b,setLanguages:N}),e.jsxs(h.Group,{className:"mb-3",children:[e.jsxs(h.Label,{children:[e.jsx(ge,{className:"me-2"})," Difficulty"]}),e.jsxs(h.Select,{value:r,onChange:c=>s(c.target.value),children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsx("p",{className:"col text-danger",children:m}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(Q.LinkContainer,{to:t?"/Challenge/"+t:"/Challenge",children:e.jsx(p,{type:"button",variant:"secondary",disabled:w,children:"Cancel"})}),e.jsx(p,{type:"submit",variant:"primary",disabled:w,children:t?"Update":"Create"})]})]})]})},He=()=>(B("Create Challenge"),e.jsx(te,{})),Re=()=>{B("Update Challenge");const{challengeId:t}=Y();return e.jsx(te,{challengeId:t})};const Ve=()=>e.jsx(je,{children:e.jsxs(P,{element:e.jsx(Te,{Header:e.jsx(pe,{variant:"light"}),Footer:null}),children:[e.jsx(P,{index:!0,element:e.jsx(Le,{})}),e.jsx(P,{element:e.jsx(_,{allowedRoles:Ce}),children:e.jsx(P,{path:":challengeId",element:e.jsx(Fe,{})})}),e.jsxs(P,{element:e.jsx(_,{allowedRoles:["Admin","Creator"]}),children:[e.jsx(P,{path:"Create",element:e.jsx(He,{})}),e.jsx(P,{path:"Edit/:challengeId",element:e.jsx(Re,{})})]})]})});export{Ve as default};
